!function(){"use strict";var n=Math.PI,t=Math.sin,e=Math.cos,r=Math.tan,a=Math.asin,u=Math.atan2,i=Math.acos,o=n/180,c=864e5,d=2440588,s=2451545;function f(n){return new Date((n+.5-d)*c)}function l(n){return function(n){return n.valueOf()/c-.5+d}(n)-s}var h=23.4397*o;function M(n,a){return u(t(n)*e(h)-r(a)*t(h),e(n))}function g(n,r){return a(t(r)*e(h)+e(r)*t(h)*t(n))}function v(n,a,i){return u(t(n),e(n)*t(a)-r(i)*e(a))}function m(n,r,u){return a(t(r)*t(u)+e(r)*e(u)*e(n))}function w(n,t){return o*(280.16+360.9856235*n)-t}function p(n){return o*(357.5291+.98560028*n)}function P(e){return e+o*(1.9148*t(e)+.02*t(2*e)+3e-4*t(3*e))+102.9372*o+n}function D(n){var t=P(p(n));return{dec:g(t,0),ra:M(t,0)}}var y={getPosition:function(n,t,e){var r=o*-e,a=o*t,u=l(n),i=D(u),c=w(u,r)-i.ra;return{azimuth:v(c,a,i.dec),altitude:m(c,a,i.dec)}}},H=y.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];y.addTime=function(n,t,e){H.push([n,t,e])};var T=9e-4;function b(t,e,r){return T+(t+e)/(2*n)+r}function E(n,e,r){return s+n+.0053*t(e)-.0069*t(2*r)}function I(n,r,a,u,o,c,d){return E(b(function(n,r,a){return i((t(n)-t(r)*t(a))/(e(r)*e(a)))}(n,a,u),r,o),c,d)}function k(n){var r=o*(134.963+13.064993*n),a=o*(93.272+13.22935*n),u=o*(218.316+13.176396*n)+6.289*o*t(r),i=5.128*o*t(a),c=385001-20905*e(r);return{ra:M(u,i),dec:g(u,i),dist:c}}function z(n,t){return new Date(n.valueOf()+t*c/24)}y.getTimes=function(t,e,r){var a,u,i,c,d,s=o*-r,h=o*e,M=function(t,e){return Math.round(t-T-e/(2*n))}(l(t),s),v=b(0,s,M),m=p(v),w=P(m),D=g(w,0),y=E(v,m,w),k={solarNoon:f(y),nadir:f(y-.5)};for(a=0,u=H.length;a<u;a+=1)d=y-((c=I((i=H[a])[0]*o,s,h,D,M,m,w))-y),k[i[1]]=f(d),k[i[2]]=f(c);return k},y.getMoonPosition=function(n,a,i){var c=o*-i,d=o*a,s=l(n),f=k(s),h=w(s,c)-f.ra,M=m(h,d,f.dec),g=u(t(h),r(d)*e(f.dec)-t(f.dec)*e(h));return M+=function(n){return n<0&&(n=0),2967e-7/Math.tan(n+.00312536/(n+.08901179))}(M),{azimuth:v(h,d,f.dec),altitude:M,distance:f.dist,parallacticAngle:g}},y.getMoonIllumination=function(n){var r=l(n),a=D(r),o=k(r),c=i(t(a.dec)*t(o.dec)+e(a.dec)*e(o.dec)*e(a.ra-o.ra)),d=u(149598e3*t(c),o.dist-149598e3*e(c)),s=u(e(a.dec)*t(a.ra-o.ra),t(a.dec)*e(o.dec)-e(a.dec)*t(o.dec)*e(a.ra-o.ra));return{fraction:(1+e(d))/2,phase:.5+.5*d*(s<0?-1:1)/Math.PI,angle:s}},y.getMoonTimes=function(n,t,e,r){var a=new Date(n);r?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var u,i,c,d,s,f,l,h,M,g,v,m,w,p=.133*o,P=y.getMoonPosition(a,t,e).altitude-p,D=1;D<=24&&(u=y.getMoonPosition(z(a,D),t,e).altitude-p,h=((s=(P+(i=y.getMoonPosition(z(a,D+1),t,e).altitude-p))/2-u)*(l=-(f=(i-P)/2)/(2*s))+f)*l+u,g=0,(M=f*f-4*s*u)>=0&&(v=l-(w=Math.sqrt(M)/(2*Math.abs(s))),m=l+w,Math.abs(v)<=1&&g++,Math.abs(m)<=1&&g++,v<-1&&(v=m)),1===g?P<0?c=D+v:d=D+v:2===g&&(c=D+(h<0?m:v),d=D+(h<0?v:m)),!c||!d);D+=2)P=i;var H={};return c&&(H.rise=z(a,c)),d&&(H.set=z(a,d)),c||d||(H[h>0?"alwaysUp":"alwaysDown"]=!0),H},"function"==typeof define&&define.amd?define(y):"undefined"!=typeof module?module.exports=y:window.SunCalc=y}();
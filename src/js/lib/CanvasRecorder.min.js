function CanvasRecorder(e,o){this.start=function(){new Promise(function(e,o){var t;e("https:"===window.location.protocol||settingsManager.offline?"getDisplayMedia"in navigator?navigator.getDisplayMedia(t).catch(e=>(console.warn("Error:"+e),null)):"getDisplayMedia"in navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia(t).catch(e=>(console.warn("Error:"+e),null)):(console.error("No Recording Support"),isVideoRecording=!1,$("#menu-record").removeClass("bmenu-item-selected"),$("#menu-record").addClass("bmenu-item-disabled"),M.toast({html:"Compatibility Error with Recording"}),$("#menu-record:animated").length||$("#menu-record").effect("shake",{distance:10}),!1):(console.error("No Recording Support in Http! Try Https!"),isVideoRecording=!1,$("#menu-record").removeClass("bmenu-item-selected"),$("#menu-record").addClass("bmenu-item-disabled"),M.toast({html:"Recording Only Available with HTTPS"}),$("#menu-record:animated").length||$("#menu-record").effect("shake",{distance:10}),!1))}).then(function(e){if(0==e)return;isVideoRecording=!0,$("#menu-record").addClass("bmenu-item-selected");let a=e;d.srcObject=e;let s=["video/webm","video/webm,codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mpeg"];for(let e in s)if(MediaRecorder.isTypeSupported(s[e])){n=s[e];break}null==n&&console.log("No supported type found for MediaRecorder");let l={mimeType:n,videoBitsPerSecond:o||1e7};t=[];try{i=new MediaRecorder(a,l)}catch(e){return isVideoRecording=!1,$("#menu-record").removeClass("bmenu-item-selected"),void console.warn("Exception while creating MediaRecorder:",e)}console.log("Created MediaRecorder",i,"with options",l),i.onstop=c,i.ondataavailable=r,i.start(100),console.log("MediaRecorder started",i)})},this.stop=function(){i.stop(),console.log("Recorded Blobs: ",t),d.controls=!0},this.save=function(e){const o=e||"recording.webm",i=new Blob(t,{type:n}),d=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=d,r.download=o,document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),window.URL.revokeObjectURL(d)},100)};var t=[],n=null,i=null;const d=document.createElement("video");function r(e){e.data&&e.data.size>0&&t.push(e.data)}function c(e){console.log("Recorder stopped: ",e);const o=new Blob(t,{type:n});d.src=window.URL.createObjectURL(o)}d.style.display="none"}
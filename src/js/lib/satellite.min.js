(function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(o="undefined"!=typeof globalThis?globalThis:o||self,o.satellite=t())})(this,function(){"use strict";function o(o,t){for(var e=[31,o%4==0?29:28,31,30,31,30,31,31,30,31,30,31],s=Math.floor(t),a=1,n=0;s>n+e[a-1]&&a<12;)n+=e[a-1],a+=1;var d=a,r=s-n,i=24*(t-s),c=Math.floor(i);i=60*(i-c);var h=Math.floor(i),m=60*(i-h);return{mon:d,day:r,hr:c,minute:h,sec:m}}function t(o,t,e,s,a,n){var d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return 367*o-Math.floor(7*(o+Math.floor((t+9)/12))*.25)+Math.floor(275*t/9)+e+1721013.5+((d/6e4+n/60+a)/60+s)/24}function e(o,e,s,a,n,d,r){if(o instanceof Date){var i=o;return t(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds())}return t(o,e,s,a,n,d,r)}function s(t,e){var s=t-2415019.5,a=s/365.25,n=1900+Math.floor(a),d=Math.floor(.25*(n-1901)),r=s-(365*(n-1900)+d)+1e-11;r<1&&(n-=1,d=Math.floor(.25*(n-1901)),r=s-(365*(n-1900)+d));var i=o(n,r),c=i.mon,h=i.day,m=i.hr,l=i.minute,p=i.sec-8.64e-7;return e?[n,c,h,m,l,Math.floor(p)]:new Date(Date.UTC(n,c-1,h,m,l,Math.floor(p)))}function a(o,t){var e,s,a,n,d,r,i,c,h,m,l,p,x,g,M,f,u,z,v,y,b,q=o.e3,w=o.ee2,T=o.peo,j=o.pgho,E=o.pho,F=o.pinco,A=o.plo,C=o.se2,L=o.se3,S=o.sgh2,U=o.sgh3,D=o.sgh4,O=o.sh2,_=o.sh3,k=o.si2,P=o.si3,Z=o.sl2,G=o.sl3,H=o.sl4,Y=o.t,$=o.xgh2,B=o.xgh3,J=o.xgh4,K=o.xh2,N=o.xh3,Q=o.xi2,V=o.xi3,W=o.xl2,X=o.xl3,oo=o.xl4,to=o.zmol,eo=o.zmos,so=t.init,ao=t.opsmode,no=t.ep,ro=t.inclp,io=t.nodep,co=t.argpp,ho=t.mp,mo=119459e-10,lo=.01675,po=.00015835218,xo=.0549;b=eo+mo*Y,"y"===so&&(b=eo),y=b+2*lo*Math.sin(b),u=Math.sin(y),m=.5*u*u-.25,l=-.5*u*Math.cos(y);var go=C*m+L*l,Mo=k*m+P*l,fo=Z*m+G*l+H*u,uo=S*m+U*l+D*u,zo=O*m+_*l;b=to+po*Y,"y"===so&&(b=to),y=b+2*xo*Math.sin(b),u=Math.sin(y),m=.5*u*u-.25,l=-.5*u*Math.cos(y);var vo=w*m+q*l,yo=Q*m+V*l,bo=W*m+X*l+oo*u,qo=$*m+B*l+J*u,wo=K*m+N*l;return p=go+vo,M=Mo+yo,f=fo+bo,x=uo+qo,g=zo+wo,"n"===so&&(p-=T,M-=F,f-=A,x-=j,g-=E,ro+=M,no+=p,n=Math.sin(ro),a=Math.cos(ro),ro>=.2?(g/=n,x-=a*g,co+=x,io+=g,ho+=f):(r=Math.sin(io),d=Math.cos(io),e=n*r,s=n*d,i=g*d+M*a*r,c=-g*r+M*a*d,e+=i,s+=c,io%=R,io<0&&"a"===ao&&(io+=R),z=ho+co+a*io,h=f+x-M*io*n,z+=h,v=io,io=Math.atan2(e,s),io<0&&"a"===ao&&(io+=R),Math.abs(v-io)>I&&(io<v?io+=R:io-=R),ho+=f,co=z-ho-a*io)),{ep:no,inclp:ro,nodep:io,argpp:co,mp:ho}}function n(o){var t,e,s,a,n,d,r,i,c,h,m,l,p,x,g,M,f,u,z,v,y,b,q,w,T,j,E,F,A,C,L,S,U,D,I,O,_,k,P,Z,G,H,Y,$,B,J,K,N,Q,V,W,X,oo,to,eo,so,ao,no,ro,io,co,ho,mo,lo=o.epoch,po=o.ep,xo=o.argpp,go=o.tc,Mo=o.inclp,fo=o.nodep,uo=o.np,zo=.01675,vo=.0549,yo=29864797e-13,bo=4.7968065e-7,qo=.39785416,wo=.91744867,To=.1945905,jo=-.98088458,Eo=uo,Fo=po,Ao=Math.sin(fo),Co=Math.cos(fo),Lo=Math.sin(xo),So=Math.cos(xo),Uo=Math.sin(Mo),Do=Math.cos(Mo),Io=Fo*Fo,Ro=1-Io,Oo=Math.sqrt(Ro),_o=0,ko=0,Po=0,Zo=0,Go=0,Ho=lo+18261.5+go/1440,Yo=(4.523602-.00092422029*Ho)%R,$o=Math.sin(Yo),Bo=Math.cos(Yo),Jo=.91375164-.03568096*Bo,Ko=Math.sqrt(1-Jo*Jo),No=.089683511*$o/Ko,Qo=Math.sqrt(1-No*No),Vo=5.8351514+.001944368*Ho,Wo=.39785416*$o/Ko,Xo=Qo*Bo+.91744867*No*$o;Wo=Math.atan2(Wo,Xo),Wo+=Vo-Yo;var ot=Math.cos(Wo),tt=Math.sin(Wo);v=To,y=jo,w=wo,T=qo,b=Co,q=Ao,m=yo;for(var et=1/Eo,st=0;st<2;)st+=1,t=v*b+y*w*q,s=-y*b+v*w*q,r=-v*q+y*w*b,i=y*T,c=y*q+v*w*b,h=v*T,e=Do*r+Uo*i,a=Do*c+Uo*h,n=-Uo*r+Do*i,d=-Uo*c+Do*h,l=t*So+e*Lo,p=s*So+a*Lo,x=-t*Lo+e*So,g=-s*Lo+a*So,M=n*Lo,f=d*Lo,u=n*So,z=d*So,co=12*l*l-3*x*x,ho=24*l*p-6*x*g,mo=12*p*p-3*g*g,X=3*(t*t+e*e)+co*Io,oo=6*(t*s+e*a)+ho*Io,to=3*(s*s+a*a)+mo*Io,eo=-6*t*n+Io*(-24*l*u-6*x*M),so=-6*(t*d+s*n)+Io*(-24*(p*u+l*z)+-6*(x*f+g*M)),ao=-6*s*d+Io*(-24*p*z-6*g*f),no=6*e*n+Io*(24*l*M-6*x*u),ro=6*(a*n+e*d)+Io*(24*(p*M+l*f)-6*(g*u+x*z)),io=6*a*d+Io*(24*p*f-6*g*z),X=X+X+Ro*co,oo=oo+oo+Ro*ho,to=to+to+Ro*mo,K=m*et,J=-.5*K/Oo,N=K*Oo,B=-15*Fo*N,Q=l*x+p*g,V=p*x+l*g,W=p*g-l*x,1===st&&(j=B,E=J,F=K,A=N,C=Q,L=V,S=W,U=X,D=oo,I=to,O=eo,_=so,k=ao,P=no,Z=ro,G=io,H=co,Y=ho,$=mo,v=ot,y=tt,w=Jo,T=Ko,b=Qo*Co+No*Ao,q=Ao*Qo-Co*No,m=bo);var at=(.2299715*Ho-Vo+4.7199672)%R,nt=(6.2565837+.017201977*Ho)%R,dt=2*j*L,rt=2*j*S,it=2*E*_,ct=2*E*(k-O),ht=-2*F*D,mt=-2*F*(I-U),lt=-2*F*(-21-9*Io)*zo,pt=2*A*Y,xt=2*A*($-H),gt=-18*A*zo,Mt=-2*E*Z,ft=-2*E*(G-P),ut=2*B*V,zt=2*B*W,vt=2*J*so,yt=2*J*(ao-eo),bt=-2*K*oo,qt=-2*K*(to-X),wt=-2*K*(-21-9*Io)*vo,Tt=2*N*ho,jt=2*N*(mo-co),Et=-18*N*vo,Ft=-2*J*ro,At=-2*J*(io-no);return{snodm:Ao,cnodm:Co,sinim:Uo,cosim:Do,sinomm:Lo,cosomm:So,day:Ho,e3:zt,ee2:ut,em:Fo,emsq:Io,gam:Vo,peo:_o,pgho:Zo,pho:Go,pinco:ko,plo:Po,rtemsq:Oo,se2:dt,se3:rt,sgh2:pt,sgh3:xt,sgh4:gt,sh2:Mt,sh3:ft,si2:it,si3:ct,sl2:ht,sl3:mt,sl4:lt,s1:B,s2:J,s3:K,s4:N,s5:Q,s6:V,s7:W,ss1:j,ss2:E,ss3:F,ss4:A,ss5:C,ss6:L,ss7:S,sz1:U,sz2:D,sz3:I,sz11:O,sz12:_,sz13:k,sz21:P,sz22:Z,sz23:G,sz31:H,sz32:Y,sz33:$,xgh2:Tt,xgh3:jt,xgh4:Et,xh2:Ft,xh3:At,xi2:vt,xi3:yt,xl2:bt,xl3:qt,xl4:wt,nm:Eo,z1:X,z2:oo,z3:to,z11:eo,z12:so,z13:ao,z21:no,z22:ro,z23:io,z31:co,z32:ho,z33:mo,zmol:at,zmos:nt}}function d(o){var t,e,s,a,n,d,r,i,c,h,m,l,p,x,g,M,f,u,z,v,y,b,q,w,T,j,E,F,A,C,L,S,U=o.cosim,D=o.argpo,O=o.s1,_=o.s2,k=o.s3,P=o.s4,Z=o.s5,H=o.sinim,Y=o.ss1,$=o.ss2,B=o.ss3,J=o.ss4,K=o.ss5,Q=o.sz1,V=o.sz3,W=o.sz11,X=o.sz13,oo=o.sz21,to=o.sz23,eo=o.sz31,so=o.sz33,ao=o.t,no=o.tc,ro=o.gsto,io=o.mo,co=o.mdot,ho=o.no,mo=o.nodeo,lo=o.nodedot,po=o.xpidot,xo=o.z1,go=o.z3,Mo=o.z11,fo=o.z13,uo=o.z21,zo=o.z23,vo=o.z31,yo=o.z33,bo=o.ecco,qo=o.eccsq,wo=o.emsq,To=o.em,jo=o.argpm,Eo=o.inclm,Fo=o.mm,Ao=o.nm,Co=o.nodem,Lo=o.irez,So=o.atime,Uo=o.d2201,Do=o.d2211,Io=o.d3210,Ro=o.d3222,Oo=o.d4410,_o=o.d4422,ko=o.d5220,Po=o.d5232,Zo=o.d5421,Go=o.d5433,Ho=o.dedt,Yo=o.didt,$o=o.dmdt,Bo=o.dnodt,Jo=o.domdt,Ko=o.del1,No=o.del2,Qo=o.del3,Vo=o.xfact,Wo=o.xlamo,Xo=o.xli,ot=o.xni,tt=17891679e-13,et=21460748e-13,st=2.2123015e-7,at=17891679e-13,nt=7.3636953e-9,dt=2.1765803e-9,rt=.0043752690880113,it=3.7393792e-7,ct=1.1428639e-7,ht=.00015835218,mt=119459e-10;Lo=0,Ao<.0052359877&&Ao>.0034906585&&(Lo=1),Ao>=.00826&&Ao<=.00924&&To>=.5&&(Lo=2);var lt=Y*mt*K,pt=$*mt*(W+X),xt=-mt*B*(Q+V-14-6*wo),gt=J*mt*(eo+so-6),Mt=-mt*$*(oo+to);(Eo<.052359877||Eo>I-.052359877)&&(Mt=0),0!==H&&(Mt/=H);var ft=gt-U*Mt;Ho=lt+O*ht*Z,Yo=pt+_*ht*(Mo+fo),$o=xt-ht*k*(xo+go-14-6*wo);var ut=P*ht*(vo+yo-6),zt=-ht*_*(uo+zo);(Eo<.052359877||Eo>I-.052359877)&&(zt=0),Jo=ft+ut,Bo=Mt,0!==H&&(Jo-=U/H*zt,Bo+=zt/H);var vt=0,yt=(ro+no*rt)%R;if(To+=Ho*ao,Eo+=Yo*ao,jo+=Jo*ao,Co+=Bo*ao,Fo+=$o*ao,0!==Lo){if(C=Math.pow(Ao/G,N),2===Lo){L=U*U;var bt=To;To=bo;var qt=wo;wo=qo,S=To*wo,x=-.306-.44*(To-.64),To<=.65?(g=3.616-13.247*To+16.29*wo,f=117.39*To-19.302-228.419*wo+156.591*S,u=109.7927*To-18.9068-214.6334*wo+146.5816*S,z=242.694*To-41.122-471.094*wo+313.953*S,v=841.88*To-146.407-1629.014*wo+1083.435*S,y=3017.977*To-532.114-5740.032*wo+3708.276*S):(g=331.819*To-72.099-508.738*wo+266.724*S,f=1582.851*To-346.844-2415.925*wo+1246.113*S,u=1554.908*To-342.585-2366.899*wo+1215.972*S,z=4758.686*To-1052.797-7193.992*wo+3651.957*S,v=16178.11*To-3581.69-24462.77*wo+12422.52*S,y=To>.715?29936.92*To-5149.66-54087.36*wo+31324.56*S:1464.74-4664.75*To+3763.64*wo),To<.7?(w=4988.61*To-919.2277-9064.77*wo+5542.21*S,b=4568.6173*To-822.71072-8491.4146*wo+5337.524*S,q=4690.25*To-853.666-8624.77*wo+5341.4*S):(w=161616.52*To-37995.78-229838.2*wo+109377.94*S,b=218913.95*To-51752.104-309468.16*wo+146349.42*S,q=170470.89*To-40023.88-242699.48*wo+115605.82*S),T=H*H,t=.75*(1+2*U+L),e=1.5*T,a=1.875*H*(1-2*U-3*L),n=-1.875*H*(1+2*U-3*L),r=35*T*t,i=39.375*T*T,c=9.84375*H*(T*(1-2*U-5*L)+.33333333*(4*U-2+6*L)),h=H*(4.92187512*T*(-2-4*U+10*L)+6.56250012*(1+2*U-3*L)),m=29.53125*H*(2-8*U+L*(8*U-12+10*L)),l=29.53125*H*(-2-8*U+L*(12+8*U-10*L)),F=Ao*Ao,A=C*C,E=3*F*A,j=E*at,Uo=j*t*x,Do=j*e*g,E*=C,j=E*it,Io=j*a*f,Ro=j*n*u,E*=C,j=2*E*nt,Oo=j*r*z,_o=j*i*v,E*=C,j=E*ct,ko=j*c*y,Po=j*h*q,j=2*E*dt,Zo=j*m*b,Go=j*l*w,Wo=(io+mo+mo-(yt+yt))%R,Vo=co+$o+2*(lo+Bo-rt)-ho,To=bt,wo=qt}1===Lo&&(p=1+wo*(.8125*wo-2.5),f=1+2*wo,M=1+wo*(6.60937*wo-6),t=.75*(1+U)*(1+U),s=.9375*H*H*(1+3*U)-.75*(1+U),d=1+U,d*=1.875*d*d,Ko=3*Ao*Ao*C*C,No=2*Ko*t*p*tt,Qo=3*Ko*d*M*st*C,Ko=Ko*s*f*et*C,Wo=(io+mo+D-yt)%R,Vo=co+po+$o+Jo+Bo-(ho+rt)),Xo=Wo,ot=ho,So=0,Ao=ho+vt}return{em:To,argpm:jo,inclm:Eo,mm:Fo,nm:Ao,nodem:Co,irez:Lo,atime:So,d2201:Uo,d2211:Do,d3210:Io,d3222:Ro,d4410:Oo,d4422:_o,d5220:ko,d5232:Po,d5421:Zo,d5433:Go,dedt:Ho,didt:Yo,dmdt:$o,dndt:vt,dnodt:Bo,domdt:Jo,del1:Ko,del2:No,del3:Qo,xfact:Vo,xlamo:Wo,xli:Xo,xni:ot}}function r(o){var t=(o-2451545)/36525,e=-62e-7*t*t*t+.093104*t*t+3164400184.812866*t+67310.54841;return e=e*O/240%R,e<0&&(e+=R),e}function i(){return(arguments.length<=0?void 0:arguments[0])instanceof Date||arguments.length>1?r(e.apply(void 0,arguments)):r.apply(void 0,arguments)}function c(o){var t=o.ecco,e=o.epoch,s=o.inclo,a=o.opsmode,n=o.no,d=t*t,r=1-d,c=Math.sqrt(r),h=Math.cos(s),m=h*h,l=Math.pow(G/n,N),p=.75*$*(3*m-1)/(c*r),x=p/(l*l),g=l*(1-x*x-x*(1/3+134*x*x/81));x=p/(g*g),n/=1+x;var M,f=Math.pow(G/n,N),u=Math.sin(s),z=f*r,v=1-5*m,y=-v-m-m,b=1/f,q=z*z,w=f*(1-t),T="n";if("a"===a){var j=e-7305,E=Math.floor(j+1e-8),F=j-E,A=.017202791694070362,C=1.7321343856509375,L=5.075514194322695e-15,S=A+R;M=(C+A*E+S*F+j*j*L)%R,M<0&&(M+=R)}else M=i(e+2433281.5);return{no:n,method:T,ainv:b,ao:f,con41:y,con42:v,cosio:h,cosio2:m,eccsq:d,omeosq:r,posq:q,rp:w,rteosq:c,sinio:u,gsto:M}}function h(o){var t,e,s,a,n,d,r,i,c=o.irez,h=o.d2201,m=o.d2211,l=o.d3210,p=o.d3222,x=o.d4410,g=o.d4422,M=o.d5220,f=o.d5232,u=o.d5421,z=o.d5433,v=o.dedt,y=o.del1,b=o.del2,q=o.del3,w=o.didt,T=o.dmdt,j=o.dnodt,E=o.domdt,F=o.argpo,A=o.argpdot,C=o.t,L=o.tc,S=o.gsto,U=o.xfact,D=o.xlamo,I=o.no,O=o.atime,_=o.em,k=o.argpm,P=o.inclm,Z=o.xli,G=o.mm,H=o.xni,Y=o.nodem,$=o.nm,B=.13130908,J=2.8843198,K=.37448087,N=5.7686396,Q=.95240898,V=1.8014998,W=1.050833,X=4.4108898,oo=.0043752690880113,to=720,eo=-720,so=259200,ao=0,no=0,ro=(S+L*oo)%R;if(_+=v*C,P+=w*C,k+=E*C,Y+=j*C,G+=T*C,0!==c){(0===O||C*O<=0||Math.abs(C)<Math.abs(O))&&(O=0,H=I,Z=D),t=C>0?to:eo;for(var io=381;381===io;)2!==c?(r=y*Math.sin(Z-B)+b*Math.sin(2*(Z-J))+q*Math.sin(3*(Z-K)),n=H+U,d=y*Math.cos(Z-B)+2*b*Math.cos(2*(Z-J))+3*q*Math.cos(3*(Z-K)),d*=n):(i=F+A*O,s=i+i,e=Z+Z,r=h*Math.sin(s+Z-N)+m*Math.sin(Z-N)+l*Math.sin(i+Z-Q)+p*Math.sin(-i+Z-Q)+x*Math.sin(s+e-V)+g*Math.sin(e-V)+M*Math.sin(i+Z-W)+f*Math.sin(-i+Z-W)+u*Math.sin(i+e-X)+z*Math.sin(-i+e-X),n=H+U,d=h*Math.cos(s+Z-N)+m*Math.cos(Z-N)+l*Math.cos(i+Z-Q)+p*Math.cos(-i+Z-Q)+M*Math.cos(i+Z-W)+f*Math.cos(-i+Z-W)+2*x*Math.cos(s+e-V)+g*Math.cos(e-V)+u*Math.cos(i+e-X)+z*Math.cos(-i+e-X),d*=n),Math.abs(C-O)>=to?io=381:(no=C-O,io=0),381===io&&(Z+=n*t+r*so,H+=r*t+d*so,O+=t);$=H+r*no+d*no*no*.5,a=Z+n*no+r*no*no*.5,1!==c?(G=a-2*Y+2*ro,ao=$-I):(G=a-Y-k+ro,ao=$-I),$=I+ao}return{atime:O,em:_,argpm:k,inclm:P,xli:Z,mm:G,xni:H,nodem:Y,dndt:ao,nm:$}}function m(o,t){var e,s,n,d,r,i,c,m,l,p,x,g,M,f,u,z,v,y,b,q,w,T,j,E,F,A,C,L=1.5e-12;o.t=t,o.error=0;var S=o.mo+o.mdot*o.t,U=o.argpo+o.argpdot*o.t,D=o.nodeo+o.nodedot*o.t;l=U,w=S;var O=o.t*o.t;if(j=D+o.nodecf*O,v=1-o.cc1*o.t,y=o.bstar*o.cc4*o.t,b=o.t2cof*O,1!==o.isimp){c=o.omgcof*o.t;var _=1+o.eta*Math.cos(S);i=o.xmcof*(_*_*_-o.delmo),z=c+i,w=S+z,l=U-z,g=O*o.t,M=g*o.t,v=v-o.d2*O-o.d3*g-o.d4*M,y+=o.bstar*o.cc5*(Math.sin(w)-o.sinmao),b=b+o.t3cof*g+M*(o.t4cof+o.t*o.t5cof)}T=o.no;var k=o.ecco;if(q=o.inclo,"d"===o.method){f=o.t;var P={irez:o.irez,d2201:o.d2201,d2211:o.d2211,d3210:o.d3210,d3222:o.d3222,d4410:o.d4410,d4422:o.d4422,d5220:o.d5220,d5232:o.d5232,d5421:o.d5421,d5433:o.d5433,dedt:o.dedt,del1:o.del1,del2:o.del2,del3:o.del3,didt:o.didt,dmdt:o.dmdt,dnodt:o.dnodt,domdt:o.domdt,argpo:o.argpo,argpdot:o.argpdot,t:o.t,tc:f,gsto:o.gsto,xfact:o.xfact,xlamo:o.xlamo,no:o.no,atime:o.atime,em:k,argpm:l,inclm:q,xli:o.xli,mm:w,xni:o.xni,nodem:j,nm:T},Y=h(P);k=Y.em,l=Y.argpm,q=Y.inclm,w=Y.mm,j=Y.nodem,T=Y.nm}if(T<=0)return o.error=2,[!1,!1];var B=Math.pow(G/T,N)*v*v;if(T=G/Math.pow(B,1.5),k-=y,k>=1||k<-.001)return o.error=1,[!1,!1];k<1e-6&&(k=1e-6),w+=o.no*b,F=w+l+j,j%=R,l%=R,F%=R,w=(F-l-j)%R;var J=Math.sin(q),Q=Math.cos(q),V=k;if(E=q,p=l,C=j,A=w,d=J,n=Q,"d"===o.method){var W={inclo:o.inclo,init:"n",ep:V,inclp:E,nodep:C,argpp:p,mp:A,opsmode:o.operationmode},X=a(o,W);if(V=X.ep,C=X.nodep,p=X.argpp,A=X.mp,E=X.inclp,E<0&&(E=-E,C+=I,p-=I),V<0||V>1)return o.error=3,[!1,!1]}"d"===o.method&&(d=Math.sin(E),n=Math.cos(E),o.aycof=-.5*K*d,Math.abs(n+1)>1.5e-12?o.xlcof=-.25*K*d*(3+5*n)/(1+n):o.xlcof=-.25*K*d*(3+5*n)/L);var oo=V*Math.cos(p);z=1/(B*(1-V*V));var to=V*Math.sin(p)+z*o.aycof,eo=A+p+C+z*o.xlcof*oo,so=(eo-C)%R;m=so,u=9999.9;for(var ao=1;Math.abs(u)>=1e-12&&ao<=10;)s=Math.sin(m),e=Math.cos(m),u=1-e*oo-s*to,u=(so-to*e+oo*s-m)/u,Math.abs(u)>=.95&&(u=u>0?.95:-.95),m+=u,ao+=1;var no=oo*e+to*s,ro=oo*s-to*e,io=oo*oo+to*to,co=B*(1-io);if(co<0)return o.error=4,[!1,!1];var ho=B*(1-no),mo=Math.sqrt(B)*ro/ho,lo=Math.sqrt(co)/ho,po=Math.sqrt(1-io);z=ro/(1+po);var xo=B/ho*(s-to-oo*z),go=B/ho*(e-oo+to*z);x=Math.atan2(xo,go);var Mo=(go+go)*xo,fo=1-2*xo*xo;z=1/co;var uo=.5*$*z,zo=uo*z;"d"===o.method&&(r=n*n,o.con41=3*r-1,o.x1mth2=1-r,o.x7thm1=7*r-1);var vo=ho*(1-1.5*zo*po*o.con41)+.5*uo*o.x1mth2*fo;if(vo<1)return o.error=6,{position:!1,velocity:!1};x-=.25*zo*o.x7thm1*Mo;var yo=C+1.5*zo*n*Mo,bo=E+1.5*zo*n*d*fo,qo=mo-T*uo*o.x1mth2*Mo/G,wo=lo+T*uo*(o.x1mth2*fo+1.5*o.con41)/G,To=Math.sin(x),jo=Math.cos(x),Eo=Math.sin(yo),Fo=Math.cos(yo),Ao=Math.sin(bo),Co=Math.cos(bo),Lo=-Eo*Co,So=Fo*Co,Uo=Lo*To+Fo*jo,Do=So*To+Eo*jo,Io=Ao*To,Ro=Lo*jo-Fo*To,Oo=So*jo-Eo*To,_o=Ao*jo,ko={x:vo*Uo*Z,y:vo*Do*Z,z:vo*Io*Z},Po={x:(qo*Uo+wo*Ro)*H,y:(qo*Do+wo*Oo)*H,z:(qo*Io+wo*_o)*H};return{position:ko,velocity:Po}}function l(o,t){var e,s,r,i,h,l,p,x,g,M,f,u,z,v,y,b,q,w,T,j,E,F,A,C,L,S,U,D,R,O,_,k,P,G,H,Y,B,Q,V,W,X,oo,to,eo,so,ao,no,ro,io,co,ho,mo,lo,po,xo,go,Mo=t.opsmode,fo=t.satn,uo=t.epoch,zo=t.xbstar,vo=t.xecco,yo=t.xargpo,bo=t.xinclo,qo=t.xmo,wo=t.xno,To=t.xnodeo,jo=1.5e-12;o.isimp=0,o.method="n",o.aycof=0,o.con41=0,o.cc1=0,o.cc4=0,o.cc5=0,o.d2=0,o.d3=0,o.d4=0,o.delmo=0,o.eta=0,o.argpdot=0,o.omgcof=0,o.sinmao=0,o.t=0,o.t2cof=0,o.t3cof=0,o.t4cof=0,o.t5cof=0,o.x1mth2=0,o.x7thm1=0,o.mdot=0,o.nodedot=0,o.xlcof=0,o.xmcof=0,o.nodecf=0,o.irez=0,o.d2201=0,o.d2211=0,o.d3210=0,o.d3222=0,o.d4410=0,o.d4422=0,o.d5220=0,o.d5232=0,o.d5421=0,o.d5433=0,o.dedt=0,o.del1=0,o.del2=0,o.del3=0,o.didt=0,o.dmdt=0,o.dnodt=0,o.domdt=0,o.e3=0,o.ee2=0,o.peo=0,o.pgho=0,o.pho=0,o.pinco=0,o.plo=0,o.se2=0,o.se3=0,o.sgh2=0,o.sgh3=0,o.sgh4=0,o.sh2=0,o.sh3=0,o.si2=0,o.si3=0,o.sl2=0,o.sl3=0,o.sl4=0,o.gsto=0,o.xfact=0,o.xgh2=0,o.xgh3=0,o.xgh4=0,o.xh2=0,o.xh3=0,o.xi2=0,o.xi3=0,o.xl2=0,o.xl3=0,o.xl4=0,o.xlamo=0,o.zmol=0,o.zmos=0,o.atime=0,o.xli=0,o.xni=0,o.bstar=zo,o.ecco=vo,o.argpo=yo,o.inclo=bo,o.mo=qo,o.no=wo,o.nodeo=To,o.operationmode=Mo;var Eo=78/Z+1,Fo=42/Z,Ao=Fo*Fo*Fo*Fo;o.init="y",o.t=0;var Co={satn:fo,ecco:o.ecco,epoch:uo,inclo:o.inclo,no:o.no,method:o.method,opsmode:o.operationmode},Lo=c(Co),So=Lo.ao,Uo=Lo.con42,Do=Lo.cosio,Io=Lo.cosio2,Ro=Lo.eccsq,Oo=Lo.omeosq,_o=Lo.posq,ko=Lo.rp,Po=Lo.rteosq,Zo=Lo.sinio;if(o.no=Lo.no,o.con41=Lo.con41,o.gsto=Lo.gsto,o.error=0,Oo>=0||o.no>=0){if(o.isimp=0,ko<220/Z+1&&(o.isimp=1),U=Eo,E=Ao,w=(ko-1)*Z,w<156){U=w-78,w<98&&(U=20);var Go=(120-U)/Z;E=Go*Go*Go*Go,U=U/Z+1}T=1/_o,ao=1/(So-U),o.eta=So*o.ecco*ao,u=o.eta*o.eta,f=o.ecco*o.eta,j=Math.abs(1-u),l=E*Math.pow(ao,4),p=l/Math.pow(j,3.5),i=p*o.no*(So*(1+1.5*u+f*(4+u))+.375*$*ao/j*o.con41*(8+3*u*(8+u))),o.cc1=o.bstar*i,h=0,o.ecco>1e-4&&(h=-2*l*ao*K*o.no*Zo/o.ecco),o.x1mth2=1-Io,o.cc4=2*o.no*p*So*Oo*(o.eta*(2+.5*u)+o.ecco*(.5+2*u)-$*ao/(So*j)*(-3*o.con41*(1-2*f+u*(1.5-.5*f))+.75*o.x1mth2*(2*u-f*(1+u))*Math.cos(2*o.argpo))),o.cc5=2*p*So*Oo*(1+2.75*(u+f)+f*u),x=Io*Io,to=1.5*$*T*o.no,eo=.5*to*$*T,so=-.46875*J*T*T*o.no,o.mdot=o.no+.5*to*Po*o.con41+.0625*eo*Po*(13-78*Io+137*x),o.argpdot=-.5*to*Uo+.0625*eo*(7-114*Io+395*x)+so*(3-36*Io+49*x),ro=-to*Do,o.nodedot=ro+(.5*eo*(4-19*Io)+2*so*(3-7*Io))*Do,no=o.argpdot+o.nodedot,o.omgcof=o.bstar*h*Math.cos(o.argpo),o.xmcof=0,o.ecco>1e-4&&(o.xmcof=-N*l*o.bstar/f),o.nodecf=3.5*Oo*ro*o.cc1,o.t2cof=1.5*o.cc1,Math.abs(Do+1)>1.5e-12?o.xlcof=-.25*K*Zo*(3+5*Do)/(1+Do):o.xlcof=-.25*K*Zo*(3+5*Do)/jo,o.aycof=-.5*K*Zo;var Ho=1+o.eta*Math.cos(o.mo);if(o.delmo=Ho*Ho*Ho,o.sinmao=Math.sin(o.mo),o.x7thm1=7*Io-1,2*I/o.no>=225){o.method="d",o.isimp=1,X=0,y=o.inclo;var Yo={epoch:uo,ep:o.ecco,argpp:o.argpo,tc:X,inclp:o.inclo,nodep:o.nodeo,np:o.no,e3:o.e3,ee2:o.ee2,peo:o.peo,pgho:o.pgho,pho:o.pho,pinco:o.pinco,plo:o.plo,se2:o.se2,se3:o.se3,sgh2:o.sgh2,sgh3:o.sgh3,sgh4:o.sgh4,sh2:o.sh2,sh3:o.sh3,si2:o.si2,si3:o.si3,sl2:o.sl2,sl3:o.sl3,sl4:o.sl4,xgh2:o.xgh2,xgh3:o.xgh3,xgh4:o.xgh4,xh2:o.xh2,xh3:o.xh3,xi2:o.xi2,xi3:o.xi3,xl2:o.xl2,xl3:o.xl3,xl4:o.xl4,zmol:o.zmol,zmos:o.zmos},$o=n(Yo);o.e3=$o.e3,o.ee2=$o.ee2,o.peo=$o.peo,o.pgho=$o.pgho,o.pho=$o.pho,o.pinco=$o.pinco,o.plo=$o.plo,o.se2=$o.se2,o.se3=$o.se3,o.sgh2=$o.sgh2,o.sgh3=$o.sgh3,o.sgh4=$o.sgh4,o.sh2=$o.sh2,o.sh3=$o.sh3,o.si2=$o.si2,o.si3=$o.si3,o.sl2=$o.sl2,o.sl3=$o.sl3,o.sl4=$o.sl4,s=$o.sinim,e=$o.cosim,g=$o.em,M=$o.emsq,F=$o.s1,A=$o.s2,C=$o.s3,L=$o.s4,S=$o.s5,D=$o.ss1,R=$o.ss2,O=$o.ss3,_=$o.ss4,k=$o.ss5,P=$o.sz1,G=$o.sz3,H=$o.sz11,Y=$o.sz13,B=$o.sz21,Q=$o.sz23,V=$o.sz31,W=$o.sz33,o.xgh2=$o.xgh2,o.xgh3=$o.xgh3,o.xgh4=$o.xgh4,o.xh2=$o.xh2,o.xh3=$o.xh3,o.xi2=$o.xi2,o.xi3=$o.xi3,o.xl2=$o.xl2,o.xl3=$o.xl3,o.xl4=$o.xl4,o.zmol=$o.zmol,o.zmos=$o.zmos,q=$o.nm,io=$o.z1,co=$o.z3,ho=$o.z11,mo=$o.z13,lo=$o.z21,po=$o.z23,xo=$o.z31,go=$o.z33;var Bo={inclo:y,init:o.init,ep:o.ecco,inclp:o.inclo,nodep:o.nodeo,argpp:o.argpo,mp:o.mo,opsmode:o.operationmode},Jo=a(o,Bo);o.ecco=Jo.ep,o.inclo=Jo.inclp,o.nodeo=Jo.nodep,o.argpo=Jo.argpp,o.mo=Jo.mp,z=0,v=0,b=0;var Ko={cosim:e,emsq:M,argpo:o.argpo,s1:F,s2:A,s3:C,s4:L,s5:S,sinim:s,ss1:D,ss2:R,ss3:O,ss4:_,ss5:k,sz1:P,sz3:G,sz11:H,sz13:Y,sz21:B,sz23:Q,sz31:V,sz33:W,t:o.t,tc:X,gsto:o.gsto,mo:o.mo,mdot:o.mdot,no:o.no,nodeo:o.nodeo,nodedot:o.nodedot,xpidot:no,z1:io,z3:co,z11:ho,z13:mo,z21:lo,z23:po,z31:xo,z33:go,ecco:o.ecco,eccsq:Ro,em:g,argpm:z,inclm:y,mm:b,nm:q,nodem:v,irez:o.irez,atime:o.atime,d2201:o.d2201,d2211:o.d2211,d3210:o.d3210,d3222:o.d3222,d4410:o.d4410,d4422:o.d4422,d5220:o.d5220,d5232:o.d5232,d5421:o.d5421,d5433:o.d5433,dedt:o.dedt,didt:o.didt,dmdt:o.dmdt,dnodt:o.dnodt,domdt:o.domdt,del1:o.del1,del2:o.del2,del3:o.del3,xfact:o.xfact,xlamo:o.xlamo,xli:o.xli,xni:o.xni},No=d(Ko);o.irez=No.irez,o.atime=No.atime,o.d2201=No.d2201,o.d2211=No.d2211,o.d3210=No.d3210,o.d3222=No.d3222,o.d4410=No.d4410,o.d4422=No.d4422,o.d5220=No.d5220,o.d5232=No.d5232,o.d5421=No.d5421,o.d5433=No.d5433,o.dedt=No.dedt,o.didt=No.didt,o.dmdt=No.dmdt,o.dnodt=No.dnodt,o.domdt=No.domdt,o.del1=No.del1,o.del2=No.del2,o.del3=No.del3,o.xfact=No.xfact,o.xlamo=No.xlamo,o.xli=No.xli,o.xni=No.xni}1!==o.isimp&&(r=o.cc1*o.cc1,o.d2=4*So*ao*r,oo=o.d2*ao*o.cc1/3,o.d3=(17*So+U)*oo,o.d4=.5*oo*So*ao*(221*So+31*U)*o.cc1,o.t3cof=o.d2+2*r,o.t4cof=.25*(3*o.d3+o.cc1*(12*o.d2+10*r)),o.t5cof=.2*(3*o.d4+12*o.cc1*o.d3+6*o.d2*o.d2+15*r*(2*o.d2+r)))}m(o,0),o.init="n"}function p(t,s){var a="i",n=1440/(2*I),d=0,r={error:0};r.satnum=t.substring(2,7),r.epochyr=parseInt(t.substring(18,20),10),r.epochdays=parseFloat(t.substring(20,32)),r.ndot=parseFloat(t.substring(33,43)),r.nddot=parseFloat(".".concat(parseInt(t.substring(44,50),10),"E").concat(t.substring(50,52))),r.bstar=parseFloat("".concat(t.substring(53,54),".").concat(parseInt(t.substring(54,59),10),"E").concat(t.substring(59,61))),r.inclo=parseFloat(s.substring(8,16)),r.nodeo=parseFloat(s.substring(17,25)),r.ecco=parseFloat(".".concat(s.substring(26,33))),r.argpo=parseFloat(s.substring(34,42)),r.mo=parseFloat(s.substring(43,51)),r.no=parseFloat(s.substring(52,63)),r.no/=n,r.a=Math.pow(r.no*Y,-2/3),r.ndot/=1440*n,r.nddot/=1440*n*1440,r.inclo*=O,r.nodeo*=O,r.argpo*=O,r.mo*=O,r.alta=r.a*(1+r.ecco)-1,r.altp=r.a*(1-r.ecco)-1,d=r.epochyr<57?r.epochyr+2e3:r.epochyr+1900;var i=o(d,r.epochdays),c=i.mon,h=i.day,m=i.hr,p=i.minute,x=i.sec;return r.jdsatepoch=e(d,c,h,m,p,x),l(r,{opsmode:a,satn:r.satnum,epoch:r.jdsatepoch-2433281.5,xbstar:r.bstar,xecco:r.ecco,xargpo:r.argpo,xinclo:r.inclo,xmo:r.mo,xno:r.no,xnodeo:r.nodeo}),r}function x(o){return g(o)||M(o)||f(o)||z()}function g(o){if(Array.isArray(o))return u(o)}function M(o){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(o))return Array.from(o)}function f(o,t){if(o){if("string"==typeof o)return u(o,t);var e=Object.prototype.toString.call(o).slice(8,-1);return"Object"===e&&o.constructor&&(e=o.constructor.name),"Map"===e||"Set"===e?Array.from(o):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(o,t):void 0}}function u(o,t){(null==t||t>o.length)&&(t=o.length);for(var e=0,s=new Array(t);e<t;e++)s[e]=o[e];return s}function z(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(){for(var o=arguments.length,t=new Array(o),s=0;s<o;s++)t[s]=arguments[s];var a=t[0],n=Array.prototype.slice.call(t,1),d=e.apply(void 0,x(n)),r=(d-a.jdsatepoch)*k;return m(a,r)}function y(o,t,e){function s(o){return o>=0?1:-1}var a=7292115e-11,n=299792.458,d={x:t.x-o.x,y:t.y-o.y,z:t.z-o.z};d.w=Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2)+Math.pow(d.z,2));var r={x:e.x+a*o.y,y:e.y-a*o.x,z:e.z},i=(d.x*r.x+d.y*r.y+d.z*r.z)/d.w;return 1+i/n*s(i)}function b(o){return o*_}function q(o){return o*O}function w(o){if(o<-I/2||o>I/2)throw new RangeError("Latitude radians must be in range [-pi/2; pi/2].");return b(o)}function T(o){if(o<-I||o>I)throw new RangeError("Longitude radians must be in range [-pi; pi].");return b(o)}function j(o){if(o<-90||o>90)throw new RangeError("Latitude degrees must be in range [-90; 90].");return q(o)}function E(o){if(o<-180||o>180)throw new RangeError("Longitude degrees must be in range [-180; 180].");return q(o)}function F(o){var t=o.longitude,e=o.latitude,s=o.height,a=6378.137,n=6356.7523142,d=(a-n)/a,r=2*d-d*d,i=a/Math.sqrt(1-r*(Math.sin(e)*Math.sin(e))),c=(i+s)*Math.cos(e)*Math.cos(t),h=(i+s)*Math.cos(e)*Math.sin(t),m=(i*(1-r)+s)*Math.sin(e);return{x:c,y:h,z:m}}function A(o,t){for(var e=6378.137,s=6356.7523142,a=Math.sqrt(o.x*o.x+o.y*o.y),n=(e-s)/e,d=2*n-n*n,r=Math.atan2(o.y,o.x)-t;r<-I;)r+=R;for(;r>I;)r-=R;for(var i,c=20,h=0,m=Math.atan2(o.z,Math.sqrt(o.x*o.x+o.y*o.y));h<c;)i=1/Math.sqrt(1-d*(Math.sin(m)*Math.sin(m))),m=Math.atan2(o.z+e*i*d*Math.sin(m),a),h+=1;var l=a/Math.cos(m)-e*i;return{longitude:r,latitude:m,height:l}}function C(o,t){var e=o.x*Math.cos(t)-o.y*Math.sin(t),s=o.x*Math.sin(t)+o.y*Math.cos(t),a=o.z;return{x:e,y:s,z:a}}function L(o,t){var e=o.x*Math.cos(t)+o.y*Math.sin(t),s=o.x*-Math.sin(t)+o.y*Math.cos(t),a=o.z;return{x:e,y:s,z:a}}function S(o,t){var e=o.longitude,s=o.latitude,a=F(o),n=t.x-a.x,d=t.y-a.y,r=t.z-a.z,i=Math.sin(s)*Math.cos(e)*n+Math.sin(s)*Math.sin(e)*d-Math.cos(s)*r,c=-Math.sin(e)*n+Math.cos(e)*d,h=Math.cos(s)*Math.cos(e)*n+Math.cos(s)*Math.sin(e)*d+Math.sin(s)*r;return{topS:i,topE:c,topZ:h}}function U(o){var t=o.topS,e=o.topE,s=o.topZ,a=Math.sqrt(t*t+e*e+s*s),n=Math.asin(s/a),d=Math.atan2(-e,t)+I;return{azimuth:d,elevation:n,rangeSat:a}}function D(o,t){var e=S(o,t);return U(e)}var I=Math.PI,R=2*I,O=I/180,_=180/I,k=1440,P=398600.5,Z=6378.137,G=60/Math.sqrt(Z*Z*Z/P),H=Z*G/60,Y=1/G,$=.00108262998905,B=-253215306e-14,J=-161098761e-14,K=B/$,N=2/3,Q=Object.freeze({__proto__:null,pi:I,twoPi:R,deg2rad:O,rad2deg:_,minutesPerDay:k,mu:P,earthRadius:Z,xke:G,vkmpersec:H,tumin:Y,j2:$,j3:B,j4:J,j3oj2:K,x2o3:N}),V={constants:Q,propagate:v,sgp4:m,twoline2satrec:p,gstime:i,jday:e,invjday:s,dopplerFactor:y,radiansToDegrees:b,degreesToRadians:q,degreesLat:w,degreesLong:T,radiansLat:j,radiansLong:E,geodeticToEcf:F,eciToGeodetic:A,eciToEcf:L,ecfToEci:C,ecfToLookAngles:D};return V});
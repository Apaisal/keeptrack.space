!function(){var e=2*Math.PI,t=e/360,s=360/e,a=1440,r=1.15741e-8;function o(e,t,o){timeManager.propRealTime=Date.now();var n=timeManager.propTimeCheck(e,timeManager.propRealTime),i=timeManager.jday(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());i+=n.getUTCMilliseconds()*r;var l,u,m,g,c,d,b=satellite.gstime(i),T=(i-o.jdsatepoch)*a,p=satellite.sgp4(o,T);if(l=satellite.eciToEcf(p.position,b),m=(u=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,l)).azimuth*s,g=u.elevation*s,c=u.rangeSat,satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz&&(!(m>=satellite.currentSensor.obsminaz&&m<=satellite.currentSensor.obsmaxaz&&g>=satellite.currentSensor.obsminel&&g<=satellite.currentSensor.obsmaxel&&c<=satellite.currentSensor.obsmaxrange&&c>=satellite.currentSensor.obsminrange)||m>=satellite.currentSensor.obsminaz2&&m<=satellite.currentSensor.obsmaxaz2&&g>=satellite.currentSensor.obsminel2&&g<=satellite.currentSensor.obsmaxel2&&c<=satellite.currentSensor.obsmaxrange2&&c>=satellite.currentSensor.obsminrange2))return 0;if((m>=satellite.currentSensor.obsminaz||m<=satellite.currentSensor.obsmaxaz)&&g>=satellite.currentSensor.obsminel&&g<=satellite.currentSensor.obsmaxel&&c<=satellite.currentSensor.obsmaxrange&&c>=satellite.currentSensor.obsminrange||(m>=satellite.currentSensor.obsminaz2||m<=satellite.currentSensor.obsmaxaz2)&&g>=satellite.currentSensor.obsminel2&&g<=satellite.currentSensor.obsmaxel2&&c<=satellite.currentSensor.obsmaxrange2&&c>=satellite.currentSensor.obsminrange2){if(satellite.isRiseSetLookangles){var h=timeManager.propTimeCheck(e-1e3*satellite.lookanglesInterval,timeManager.propRealTime),v=timeManager.jday(h.getUTCFullYear(),h.getUTCMonth()+1,h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds());v+=h.getUTCMilliseconds()*r;var S,C,x,M,f,z=satellite.gstime(v),U=(v-o.jdsatepoch)*a,L=satellite.sgp4(o,U);return S=satellite.eciToEcf(L.position,z),x=(C=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,S)).azimuth*s,M=C.elevation*s,f=C.rangeSat,!((m>=satellite.currentSensor.obsminaz||m<=satellite.currentSensor.obsmaxaz)&&g>=satellite.currentSensor.obsminel&&g<=satellite.currentSensor.obsmaxel&&c<=satellite.currentSensor.obsmaxrange&&c>=satellite.currentSensor.obsminrange)||(m>=satellite.currentSensor.obsminaz2||m<=satellite.currentSensor.obsmaxaz2)&&g>=satellite.currentSensor.obsminel2&&g<=satellite.currentSensor.obsmaxel2&&c<=satellite.currentSensor.obsmaxrange2&&c>=satellite.currentSensor.obsminrange2?((d=t.insertRow()).insertCell().appendChild(document.createTextNode(timeManager.dateFormat(n,"isoDateTime",!0))),d.insertCell().appendChild(document.createTextNode(g.toFixed(1))),d.insertCell().appendChild(document.createTextNode(m.toFixed(0))),d.insertCell().appendChild(document.createTextNode(c.toFixed(0))),1):(h=timeManager.propTimeCheck(e+1e3*satellite.lookanglesInterval,timeManager.propRealTime),v=timeManager.jday(h.getUTCFullYear(),h.getUTCMonth()+1,h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds()),v+=h.getUTCMilliseconds()*r,z=satellite.gstime(v),U=(v-o.jdsatepoch)*a,L=satellite.sgp4(o,U),S=satellite.eciToEcf(L.position,z),x=(C=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,S)).azimuth*s,M=C.elevation*s,f=C.rangeSat,!((x>=satellite.currentSensor.obsminaz||x<=satellite.currentSensor.obsmaxaz)&&M>=satellite.currentSensor.obsminel&&M<=satellite.currentSensor.obsmaxel&&f<=satellite.currentSensor.obsmaxrange&&f>=satellite.currentSensor.obsminrange)||(x>=satellite.currentSensor.obsminaz2||x<=satellite.currentSensor.obsmaxaz2)&&M>=satellite.currentSensor.obsminel2&&M<=satellite.currentSensor.obsmaxel2&&f<=satellite.currentSensor.obsmaxrange2&&f>=satellite.currentSensor.obsminrange2?((d=t.insertRow()).insertCell().appendChild(document.createTextNode(timeManager.dateFormat(n,"isoDateTime",!0))),d.insertCell().appendChild(document.createTextNode(g.toFixed(1))),d.insertCell().appendChild(document.createTextNode(m.toFixed(0))),d.insertCell().appendChild(document.createTextNode(c.toFixed(0))),1):0)}return(d=t.insertRow()).insertCell().appendChild(document.createTextNode(timeManager.dateFormat(n,"isoDateTime",!0))),d.insertCell().appendChild(document.createTextNode(g.toFixed(1))),d.insertCell().appendChild(document.createTextNode(m.toFixed(0))),d.insertCell().appendChild(document.createTextNode(c.toFixed(0))),1}return 0}function n(e,t,o,n){n=satellite.sensorListUS[n].googleName;var i=Date.now(),l=timeManager.propTimeCheck(e,i),u=timeManager.jday(l.getUTCFullYear(),l.getUTCMonth()+1,l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds());u+=l.getUTCMilliseconds()*r;var m,g,c,d,b,T=satellite.gstime(u),p=(u-o.jdsatepoch)*a,h=satellite.sgp4(o,p);if(m=satellite.eciToEcf(h.position,T),c=(g=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,m)).azimuth*s,d=g.elevation*s,b=g.rangeSat,satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz&&(!(c>=satellite.currentSensor.obsminaz&&c<=satellite.currentSensor.obsmaxaz&&d>=satellite.currentSensor.obsminel&&d<=satellite.currentSensor.obsmaxel&&b<=satellite.currentSensor.obsmaxrange&&b>=satellite.currentSensor.obsminrange)||c>=satellite.currentSensor.obsminaz2&&c<=satellite.currentSensor.obsmaxaz2&&d>=satellite.currentSensor.obsminel2&&d<=satellite.currentSensor.obsmaxel2&&b<=satellite.currentSensor.obsmaxrange2&&b>=satellite.currentSensor.obsminrange2))return 0;if((c>=satellite.currentSensor.obsminaz||c<=satellite.currentSensor.obsmaxaz)&&d>=satellite.currentSensor.obsminel&&d<=satellite.currentSensor.obsmaxel&&b<=satellite.currentSensor.obsmaxrange&&b>=satellite.currentSensor.obsminrange||(c>=satellite.currentSensor.obsminaz2||c<=satellite.currentSensor.obsmaxaz2)&&d>=satellite.currentSensor.obsminel2&&d<=satellite.currentSensor.obsmaxel2&&b<=satellite.currentSensor.obsmaxrange2&&b>=satellite.currentSensor.obsminrange2){var v;if(t.rows.length>0)for(var S=0;S<t.rows.length;S++){var C=t.rows[S].cells[0].textContent,x=parseInt(C.substr(0,4)),M=parseInt(C.substr(5,2))-1,f=parseInt(C.substr(8,2)),z=parseInt(C.substr(11,2)),U=parseInt(C.substr(14,2)),L=parseInt(C.substr(17,2)),D=new Date(x,M,f,z,U,L);if(D.setUTCDate(f),D.setUTCHours(z),l<D){v=t.insertRow(S);break}}return null==v&&(v=t.insertRow()),v.insertCell().appendChild(document.createTextNode(timeManager.dateFormat(l,"isoDateTime",!0))),v.insertCell().appendChild(document.createTextNode(d.toFixed(1))),v.insertCell().appendChild(document.createTextNode(c.toFixed(0))),v.insertCell().appendChild(document.createTextNode(b.toFixed(0))),v.insertCell().appendChild(document.createTextNode(n)),1}return 0}satellite.lookanglesInterval=5,satellite.lookanglesLength=2,satellite.isRiseSetLookangles=!1,satellite.currentSensor={},satellite.tempSensor={},satellite.currentTEARR={},satellite.defaultSensor={},satellite.defaultSensor.observerGd={lat:null,longitude:0,latitude:0,height:0},satellite.currentSensor=satellite.defaultSensor,satellite.sensorListUS=[window.sensorManager.sensorList.COD,window.sensorManager.sensorList.BLE,window.sensorManager.sensorList.CAV,window.sensorManager.sensorList.CLR,window.sensorManager.sensorList.EGL,window.sensorManager.sensorList.FYL,window.sensorManager.sensorList.THL,window.sensorManager.sensorList.MIL,window.sensorManager.sensorList.ALT,window.sensorManager.sensorList.ASC,window.sensorManager.sensorList.CDN],satellite.sensorSelected=function(){return null!=satellite.currentSensor.lat},satellite.currentEpoch=function(e){var t=(e=new Date(e)).getUTCFullYear();t=parseInt(t.toString().substr(2,2));var s=a(timeManager.getDayOfYear(e),3);function a(e,t){return e.length<t?a("0"+e,t):e}return[t,s=a(s=(s+(60*e.getUTCHours()+e.getUTCMinutes())/1440).toFixed(8),12)]},satellite.distance=function(e,t){if(null==t||null==e)return"";if("Star"===t.type||"Star"===e.type)return"";var s=Math.pow(e.position.x-t.position.x,2),a=Math.pow(e.position.y-t.position.y,2),r=Math.pow(e.position.z-t.position.z,2);return"<br />"+Math.sqrt(s+a+r).toFixed(0)+" km"},satellite.getsensorinfo=function(){$("#sensor-latitude").html(satellite.currentSensor.lat),$("#sensor-longitude").html(satellite.currentSensor.long),$("#sensor-minazimuth").html(satellite.currentSensor.obsminaz),$("#sensor-maxazimuth").html(satellite.currentSensor.obsmaxaz),$("#sensor-minelevation").html(satellite.currentSensor.obsminel),$("#sensor-maxelevation").html(satellite.currentSensor.obsmaxel),$("#sensor-minrange").html(satellite.currentSensor.obsminrange),$("#sensor-maxrange").html(satellite.currentSensor.obsmaxrange)},satellite.setobs=function(e,s){if(s)return satellite.currentSensor=satellite.defaultSensor,void $(".sensor-reset-menu").hide();$("#menu-sensor-info").removeClass("bmenu-item-disabled"),$("#menu-fov-bubble").removeClass("bmenu-item-disabled"),$("#menu-surveillance").removeClass("bmenu-item-disabled"),$("#menu-planetarium").removeClass("bmenu-item-disabled"),$("#menu-astronomy").removeClass("bmenu-item-disabled"),$(".sensor-reset-menu").show(),satellite.currentSensor=e,satellite.currentSensor.observerGd={latitude:e.lat*t,longitude:e.long*t,height:1*e.obshei}},satellite.altitudeCheck=function(e,t,s){var o;void 0!==e.TLE1?(s=t,o=satellite.twoline2satrec(e.TLE1,e.TLE2)):o=satellite.twoline2satrec(e,t);var n=timeManager.propTimeCheck(s,timeManager.propRealTime),i=timeManager.jday(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());i+=n.getUTCMilliseconds()*r;var l,u=satellite.gstime(i),m=(i-o.jdsatepoch)*a,g=satellite.sgp4(o,m);try{l=satellite.eciToGeodetic(g.position,u)}catch(e){return 0}return l.height},satellite.getDirection=function(e){var t=satellite.getTEARR(e).lat,s=timeManager.propTimeCheck(5e3,timeManager.propTime()),a=satellite.getTEARR(e,void 0,s).lat;if((t*=RAD2DEG)<(a*=RAD2DEG))return"N";if(t>a)return"S";if(t===a){if(s=timeManager.propTimeCheck(2e4,timeManager.propTime()),futureTEARR=satellite.getTEARR(e,void 0,s),t<a)return"N";if(t>a)return"S"}return console.error("Sat Direction Calculation Error - By Pole?"),"Error"},satellite.getTEARR=function(e,t,o){var n={};if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd){try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}if(void 0===t.observerGd.longitude)try{t.observerGd={height:t.alt,latitude:t.lat*DEG2RAD,longitude:t.lon*DEG2RAD}}catch(e){throw"observerGd is not set and could not be guessed."}}var i,l=satellite.twoline2satrec(e.TLE1,e.TLE2);i=void 0===o?timeManager.propTime():o;var u=timeManager.jday(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds());u+=i.getUTCMilliseconds()*r;var m,g,c,d=satellite.gstime(u),b=(u-l.jdsatepoch)*a,T=satellite.sgp4(l,b);try{c=satellite.eciToGeodetic(T.position,d),n.alt=c.height,n.lon=c.longitude,n.lat=c.latitude,m=satellite.eciToEcf(T.position,d),g=satellite.ecfToLookAngles(t.observerGd,m),n.azimuth=g.azimuth*s,n.elevation=g.elevation*s,n.range=g.rangeSat}catch(e){n.alt=0,n.lon=0,n.lat=0,m=0,g=0,n.azimuth=0,n.elevation=0,n.range=0}return t.obsminaz>t.obsmaxaz?(n.azimuth>=t.obsminaz||n.azimuth<=t.obsmaxaz)&&n.elevation>=t.obsminel&&n.elevation<=t.obsmaxel&&n.range<=t.obsmaxrange&&n.range>=t.obsminrange||(n.azimuth>=t.obsminaz2||n.azimuth<=t.obsmaxaz2)&&n.elevation>=t.obsminel2&&n.elevation<=t.obsmaxel2&&n.range<=t.obsmaxrange2&&n.range>=t.obsminrange2?n.inview=!0:n.inview=!1:n.azimuth>=t.obsminaz&&n.azimuth<=t.obsmaxaz&&n.elevation>=t.obsminel&&n.elevation<=t.obsmaxel&&n.range<=t.obsmaxrange&&n.range>=t.obsminrange||n.azimuth>=t.obsminaz2&&n.azimuth<=t.obsmaxaz2&&n.elevation>=t.obsminel2&&n.elevation<=t.obsmaxel2&&n.range<=t.obsmaxrange2&&n.range>=t.obsminrange2?n.inview=!0:n.inview=!1,satellite.currentTEARR=n,n},satellite.calculateSatrec=function(){console.time("satrecCache");for(var e,t=[],s=0;s<satSet.getSatData().length;s++)sat=satSet.getSat(s),sat.static||sat.missile||!sat.active||(e=satellite.twoline2satrec(sat.TLE1,sat.TLE2),t.push({SCC_NUM:sat.SCC_NUM,satrec:e}));window.satrecCache=t,console.timeEnd("satrecCache")},satellite.nextpassList=function(e){for(var t=[],s=0;s<e.length;s++)for(var a=satellite.next5passes(e[s],void 0,864e5),r=0;r<a.length;r++)t.push({SCC_NUM:e[s].SCC_NUM,time:a[r]});return t},satellite.nextpass=function(e,t,o,n){if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd)try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===o&&(o=satellite.lookanglesLength),void 0===n&&(n=satellite.lookanglesInterval);for(var i=timeManager.getPropOffset(),l=0,u=satellite.twoline2satrec(e.TLE1,e.TLE2),m=0;m<24*o*60*60;m+=n){l=1e3*m+i;var g=timeManager.propTimeCheck(l,timeManager.propRealTime),c=timeManager.jday(g.getUTCFullYear(),g.getUTCMonth()+1,g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds());c+=g.getUTCMilliseconds()*r;var d,b,T,p,h,v=satellite.gstime(c),S=(c-u.jdsatepoch)*a,C=satellite.sgp4(u,S);if(d=satellite.eciToEcf(C.position,v),T=(b=satellite.ecfToLookAngles(t.observerGd,d)).azimuth*s,p=b.elevation*s,h=b.rangeSat,t.obsminaz>t.obsmaxaz){if((T>=t.obsminaz||T<=t.obsmaxaz)&&p>=t.obsminel&&p<=t.obsmaxel&&h<=t.obsmaxrange&&h>=t.obsminrange||(T>=t.obsminaz2||T<=t.obsmaxaz2)&&p>=t.obsminel2&&p<=t.obsmaxel2&&h<=t.obsmaxrange2&&h>=t.obsminrange2)return timeManager.dateFormat(g,"isoDateTime",!0)}else if(T>=t.obsminaz&&T<=t.obsmaxaz&&p>=t.obsminel&&p<=t.obsmaxel&&h<=t.obsmaxrange&&h>=t.obsminrange||T>=t.obsminaz2&&T<=t.obsmaxaz2&&p>=t.obsminel2&&p<=t.obsmaxel2&&h<=t.obsmaxrange2&&h>=t.obsminrange2)return timeManager.dateFormat(g,"isoDateTime",!0)}return"No Passes in "+satellite.lookanglesLength+" Days"},satellite.next5passes=function(t,o,n,i){if(void 0===o){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";o=satellite.currentSensor}if(void 0===o.observerGd)try{o.observerGd={height:o.obshei,latitude:o.lat,longitude:o.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===n&&(n=satellite.lookanglesLength),void 0===i&&(i=satellite.lookanglesInterval);for(var l=[],u=timeManager.getPropOffset(),m=0,g=satellite.twoline2satrec(t.TLE1,t.TLE2),c=a/(g.no*a/e),d=0;d<24*n*60*60;d+=i){if(l.length>=5)return l;m=1e3*d+u;var b=timeManager.propTimeCheck(m,timeManager.propRealTime),T=timeManager.jday(b.getUTCFullYear(),b.getUTCMonth()+1,b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds());T+=b.getUTCMilliseconds()*r;var p,h,v,S,C,x=satellite.gstime(T),M=(T-g.jdsatepoch)*a,f=satellite.sgp4(g,M);p=satellite.eciToEcf(f.position,x),v=(h=satellite.ecfToLookAngles(o.observerGd,p)).azimuth*s,S=h.elevation*s,C=h.rangeSat,o.obsminaz>o.obsmaxaz?((v>=o.obsminaz||v<=o.obsmaxaz)&&S>=o.obsminel&&S<=o.obsmaxel&&C<=o.obsmaxrange&&C>=o.obsminrange||(v>=o.obsminaz2||v<=o.obsmaxaz2)&&S>=o.obsminel2&&S<=o.obsmaxel2&&C<=o.obsmaxrange2&&C>=o.obsminrange2)&&(l.push(b),d+=60*c*.75):(v>=o.obsminaz&&v<=o.obsmaxaz&&S>=o.obsminel&&S<=o.obsmaxel&&C<=o.obsmaxrange&&C>=o.obsminrange||v>=o.obsminaz2&&v<=o.obsmaxaz2&&S>=o.obsminel2&&S<=o.obsmaxel2&&C<=o.obsmaxrange2&&C>=o.obsminrange2)&&(l.push(b),d+=60*c*.75)}return l},satellite.getlookanglesMultiSite=function(t,s){if(s){var r=!1;satellite.sensorSelected()||(r=!0);var o=timeManager.getPropOffset();satellite.tempSensor=satellite.currentSensor,satellite.setobs(satellite.sensorListUS[0]);var i=satellite.twoline2satrec(t.TLE1,t.TLE2),l=a/(i.no*a/e),u=document.getElementById("looksmultisite");u.innerHTML="";var m=0,g=0,c=0,d=6,b=u.insertRow(),T=b.insertCell();T.appendChild(document.createTextNode("Time")),T.setAttribute("style","text-decoration: underline");var p=b.insertCell();p.appendChild(document.createTextNode("El")),p.setAttribute("style","text-decoration: underline");var h=b.insertCell();h.appendChild(document.createTextNode("Az")),h.setAttribute("style","text-decoration: underline");var v=b.insertCell();v.appendChild(document.createTextNode("Rng")),v.setAttribute("style","text-decoration: underline");var S=b.insertCell();S.appendChild(document.createTextNode("Sensor")),S.setAttribute("style","text-decoration: underline");for(var C=0;C<24*satellite.lookanglesLength*60*60;C+=satellite.lookanglesInterval){if((m+=n(1e3*C+o,u,i,c))>g&&(g++,1===d?(c++,satellite.setobs(satellite.sensorListUS[c]),C=0,d=6):(d-=1,C+=60*l*.75)),c===satellite.sensorListUS.length-1){satellite.currentSensor=r?satellite.defaultSensor:satellite.tempSensor;break}c<satellite.sensorListUS.length-1&&C>=24*satellite.lookanglesLength*60*60-satellite.lookanglesInterval&&(c++,satellite.setobs(satellite.sensorListUS[c]),C=0,d=6)}satellite.currentSensor=r?satellite.defaultSensor:satellite.tempSensor}},satellite.getOrbitByLatLon=function(e,t,o,n,i,l,u){var m,g,c,d,b,T,p,h,v,S;for(void 0===u&&(u=0),S=0;S<5200;S+=1){if(1===(p=z(S))){if(v===n){S;break}S+=20}5===p&&(S+=100)}if(2===p)return console.warn("meanACalcResults failed after trying all combinations!"),["Error",""];if(void 0!==l&&0!==l)for(p=0,S=0;S<3600;S+=1){if(1===(T=f(S))){if(1===p&&v===n)break}else console.log("Failed Arg of Per Calc");if(5===T&&(S+=50),2===T)return["Error",""];for(var C=0;C<5200;C+=1){if(1===(p=z(C))){if(v===n)break;C+=20}if(5===p&&(C+=100),2===p)return["Error",""]}}for(S=0;S<52e4;S+=1){var x=U(S,u);if(1===x)break;5===x&&(S+=1e3)}return[m,g];function M(e,t){return e.length<t?M("0"+e,t):e}function f(t){var a,r,o=satellite.twoline2satrec(e.TLE1,e.TLE2);(a=(a=void 0===c?(o.mo*s).toPrecision(10):c).split("."))[0]=a[0].substr(-3,3),a[1]=a[1].substr(0,4),a=M(a=(a[0]+"."+a[1]).toString(),8),(r=(r=void 0===d?(e.raan*s).toPrecision(7):d).split("."))[0]=r[0].substr(-3,3),r[1]=r[1].substr(0,4),r=M(r=(r[0]+"."+r[1]).toString(),8),d=r;var n=e.SCC_NUM,l=e.TLE1.substr(9,8),u=(e.inclination*s).toPrecision(7);(u=u.split("."))[0]=u[0].substr(-3,3),u[1]=u[1].substr(0,4),u=M(u=(u[0]+"."+u[1]).toString(),8);var T=e.TLE1.substr(18,2),p=e.TLE1.substr(20,12),h=e.TLE2.substr(52,11),v=e.eccentricity.toPrecision(7).substr(2,7);t/=10,t=M(t=parseFloat(t).toPrecision(7),8);var S=e.TLE1.substr(32,39);m="1 "+n+"U "+l+" "+T+p+S,g="2 "+n+" "+u+" "+r+" "+v+" "+t+" "+a+" "+h+"    10",o=satellite.twoline2satrec(m,g);var C=L(i,o,3);return e.TLE1=m,e.TLE2=g,b=t,C}function z(t){var a=satellite.twoline2satrec(e.TLE1,e.TLE2);t/=10,t=M(t=parseFloat(t).toPrecision(7),8);var r=(e.raan*s).toPrecision(7);d=r,(r=r.toString().split("."))[0]=r[0].substr(-3,3),r[1]=r[1].substr(0,4),r=M(r=(r[0]+"."+r[1]).toString(),8);var o=e.SCC_NUM,n=e.TLE1.substr(9,8),l=(e.inclination*s).toPrecision(7);(l=l.split("."))[0]=l[0].substr(-3,3),l[1]=l[1].substr(0,4),l=M(l=(l[0]+"."+l[1]).toString(),8);var u,T=e.TLE1.substr(18,2),p=e.TLE1.substr(20,12),h=e.TLE2.substr(52,11),v=e.eccentricity.toPrecision(7).substr(2,7);(u=(u=void 0===b?(e.argPe*s).toPrecision(7):b).split("."))[0]=u[0].substr(-3,3),u[1]=u[1].substr(0,4),u=M(u=(u[0]+"."+u[1]).toString(),8);var S="1 "+o+"U "+n+" "+T+p+e.TLE1.substr(32,39),C="2 "+o+" "+l+" "+r+" "+v+" "+u+" "+t+" "+h+"    10";a=satellite.twoline2satrec(S,C);var x=L(i,a,1);return 1===x&&(m=S,g=C,e.TLE1=S,e.TLE2=C,c=t),x}function U(t,a){var r=satellite.twoline2satrec(e.TLE1,e.TLE2),o=c;rascNum=t,(t/=100)>360&&(t-=360),(t=(t=t.toPrecision(7)).split("."))[0]=t[0].substr(-3,3),t[1]=t[1].substr(0,4),t=M(t=(t[0]+"."+t[1]).toString(),8),d=t;var n=e.SCC_NUM,l=e.TLE1.substr(9,8),u=(e.inclination*s).toPrecision(7);(u=u.split("."))[0]=u[0].substr(-3,3),u[1]=u[1].substr(0,4),u=M(u=(u[0]+"."+u[1]).toString(),8);var T,p=e.TLE1.substr(18,2),h=e.TLE1.substr(20,12),v=e.TLE2.substr(52,11),S=e.eccentricity.toPrecision(7).substr(2,7);(T=(T=void 0===b?(e.argPe*s).toPrecision(7):b).split("."))[0]=T[0].substr(-3,3),T[1]=T[1].substr(0,4),T=M(T=(T[0]+"."+T[1]).toString(),8);var C=e.TLE1.substr(32,39);m="1 "+n+"U "+l+" "+p+h+C,g="2 "+n+" "+u+" "+t+" "+S+" "+T+" "+o+" "+v+"    10",r=satellite.twoline2satrec(m,g);var x=L(i,r,2);return 1===x&&(e.TLE1=m,(t=rascNum/100+a)>360&&(t-=360),t<0&&(t+=360),(t=(t=t.toPrecision(7)).split("."))[0]=t[0].substr(-3,3),t[1]=t[1].substr(0,4),t=M(t=(t[0]+"."+t[1]).toString(),8),d=t,g="2 "+n+" "+u+" "+t+" "+S+" "+T+" "+o+" "+v+"    10",e.TLE2=g),x}function L(e,s,n){timeManager.propRealTime=Date.now();var i=timeManager.propTimeCheck(e,timeManager.propRealTime),u=timeManager.jday(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds());u+=i.getUTCMilliseconds()*r;var m,g,c,d,b=satellite.gstime(u),T=(u-s.jdsatepoch)*a,p=satellite.sgp4(s,T);void 0===p&&console.log(s);try{m=satellite.eciToGeodetic(p.position,b)}catch(e){return console.warn(e),2}if(g=1*satellite.degreesLat(m.latitude),c=1*satellite.degreesLong(m.longitude),d=m.height,null==h&&(h=g),1===n){if(g===h)return 0;g>h&&(v="N"),g<h&&(v="S"),h=g}return g>t-.15&&g<t+.15&&1===n?1:c>o-.15&&c<o+.15&&2===n?1:d>l-30&&d<l+30&&3===n?1:(g>t-11&&g<t+11||1!==n)&&(c>o-11&&c<o+11||2!==n)?(d<l-100||d>l+100)&&3===n?5:0:5}},satellite.calculateLookAngles=function(e,o,n){var i;!function(){if(void 0===o){if(!satellite.sensorSelected())return void console.error("getlookangles2 requires a sensor!");o=satellite.currentSensor}else{if(void 0===o.obsminaz)return void console.error("sensor format incorrect");o.observerGd={latitude:o.lat*t,longitude:o.long*t,height:1*o.obshei}}void 0===e?console.error("sat parameter required!"):void 0!==e.TLE1&&void 0!==e.TLE2||console.error("sat parameter invalid format!"),void 0===i&&(i=0),void 0===satellite.isRiseSetLookangles&&(satellite.isRiseSetLookangles=!1)}();var l,u=0,m=satellite.twoline2satrec(e.TLE1,e.TLE2),g=[];satellite.isRiseSetLookangles&&(l=satellite.lookanglesInterval,satellite.lookanglesInterval=1);for(var c=0;c<24*satellite.lookanglesLength*60*60;c+=satellite.lookanglesInterval)u=1e3*c+i,g.length<=5e3&&(lookanglesRow=d(u,m),"undefined"!=typeof lookanglesRow&&g.push(lookanglesRow));function d(e,t){var n=new Date;n.setTime(Number(Date.now())+e);var i=b(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());i+=n.getUTCMilliseconds()*r;var l,u,m,g,c,d=satellite.gstime(i),T=(i-t.jdsatepoch)*a,p=satellite.sgp4(t,T);if(l=satellite.eciToEcf(p.position,d),m=(u=satellite.ecfToLookAngles(o.observerGd,l)).azimuth*s,g=u.elevation*s,c=u.rangeSat,(!(o.obsminaz<o.obsmaxaz)||m>=o.obsminaz&&m<=o.obsmaxaz&&g>=o.obsminel&&g<=o.obsmaxel&&c<=o.obsmaxrange&&c>=o.obsminrange&&!(m>=o.obsminaz2&&m<=o.obsmaxaz2&&g>=o.obsminel2&&g<=o.obsmaxel2&&c<=o.obsmaxrange2&&c>=o.obsminrange2))&&((m>=o.obsminaz||m<=o.obsmaxaz)&&g>=o.obsminel&&g<=o.obsmaxel&&c<=o.obsmaxrange&&c>=o.obsminrange||(m>=o.obsminaz2||m<=o.obsmaxaz2)&&g>=o.obsminel2&&g<=o.obsmaxel2&&c<=o.obsmaxrange2&&c>=o.obsminrange2)){if(satellite.isRiseSetLookangles){var h=new Date;h.setTime(Number(Date.now())+e-1e3*satellite.lookanglesInterval);var v=timeManager.jday(h.getUTCFullYear(),h.getUTCMonth()+1,h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds());v+=h.getUTCMilliseconds()*r;var S,C,x,M,f,z=satellite.gstime(v),U=(v-t.jdsatepoch)*a,L=satellite.sgp4(t,U);return S=satellite.eciToEcf(L.position,z),x=(C=satellite.ecfToLookAngles(o.observerGd,S)).azimuth*s,M=C.elevation*s,f=C.rangeSat,!((m>=o.obsminaz||m<=o.obsmaxaz)&&g>=o.obsminel&&g<=o.obsmaxel&&c<=o.obsmaxrange&&c>=o.obsminrange)||(m>=o.obsminaz2||m<=o.obsmaxaz2)&&g>=o.obsminel2&&g<=o.obsmaxel2&&c<=o.obsmaxrange2&&c>=o.obsminrange2?{time:timeManager.dateFormat(n,"isoDateTime",!0),rng:c,az:m,el:g}:(h.setTime(Number(Date.now())+e-1e3*satellite.lookanglesInterval),v=b(h.getUTCFullYear(),h.getUTCMonth()+1,h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds()),v+=h.getUTCMilliseconds()*r,z=satellite.gstime(v),U=(v-t.jdsatepoch)*a,L=satellite.sgp4(t,U),S=satellite.eciToEcf(L.position,z),x=(C=satellite.ecfToLookAngles(o.observerGd,S)).azimuth*s,M=C.elevation*s,f=C.rangeSat,!((x>=o.obsminaz||x<=o.obsmaxaz)&&M>=o.obsminel&&M<=o.obsmaxel&&f<=o.obsmaxrange&&f>=o.obsminrange)||(x>=o.obsminaz2||x<=o.obsmaxaz2)&&M>=o.obsminel2&&M<=o.obsmaxel2&&f<=o.obsmaxrange2&&f>=o.obsminrange2?{time:timeManager.dateFormat(n,"isoDateTime",!0),rng:c,az:m,el:g}:void 0)}return{time:timeManager.dateFormat(n,"isoDateTime",!0),rng:c,az:m,el:g}}}function b(e,t,s,a,r,o){return e?367*e-Math.floor(7*(e+Math.floor((t+9)/12))*.25)+Math.floor(275*t/9)+s+1721013.5+((o/60+r)/60+a)/24:(n=Date.now(),jDayStart=new Date(n.getFullYear(),0,0),jDayDiff=n-jDayStart,Math.floor(jDayDiff/MILLISECONDS_PER_DAY));var n}return satellite.isRiseSetLookangles&&(satellite.lookanglesInterval=l),g},satellite.getlookangles=function(e,t){if(t&&satellite.sensorSelected()){var s=0,a=timeManager.getPropOffset(),r=satellite.twoline2satrec(e.TLE1,e.TLE2),n=document.getElementById("looks");n.innerHTML="";var i=0,l=n.insertRow(),u=l.insertCell();u.appendChild(document.createTextNode("Time")),u.setAttribute("style","text-decoration: underline");var m=l.insertCell();m.appendChild(document.createTextNode("El")),m.setAttribute("style","text-decoration: underline");var g=l.insertCell();g.appendChild(document.createTextNode("Az")),g.setAttribute("style","text-decoration: underline");var c,d=l.insertCell();d.appendChild(document.createTextNode("Rng")),d.setAttribute("style","text-decoration: underline"),satellite.isRiseSetLookangles&&(c=satellite.lookanglesInterval,satellite.lookanglesInterval=1);for(var b=0;b<24*satellite.lookanglesLength*60*60&&(s=1e3*b+a,!(i>=1500));b+=satellite.lookanglesInterval)i+=o(s,n,r);satellite.isRiseSetLookangles&&(satellite.lookanglesInterval=c)}},satellite.getDOPsTable=function(e,t,s){var a,r=document.getElementById("dops");r.innerHTML="";var o=timeManager.getPropOffset(),n=0,i=r.insertRow(),l=i.insertCell();l.appendChild(document.createTextNode("Time"));var u=i.insertCell();u.appendChild(document.createTextNode("HDOP"));var m=i.insertCell();m.appendChild(document.createTextNode("PDOP"));var g=i.insertCell();g.appendChild(document.createTextNode("GDOP"));for(var c=0;c<1440;c++)n=1e3*c*60+o,a=timeManager.propTimeCheck(n,timeManager.propRealTime),dops=satellite.getDOPs(e,t,s,!1,a),(l=(i=r.insertRow()).insertCell()).appendChild(document.createTextNode(timeManager.dateFormat(a,"isoDateTime",!0))),(u=i.insertCell()).appendChild(document.createTextNode(dops.HDOP)),(m=i.insertCell()).appendChild(document.createTextNode(dops.PDOP)),(g=i.insertCell()).appendChild(document.createTextNode(dops.GDOP))},satellite.getDOPs=function(e,t,s,a,r){if(void 0!==e){if(void 0!==t){var o,n;s=void 0!==s?s:0,a=void 0!==a&&a,e*=DEG2RAD,t*=DEG2RAD;var i=[];void 0===groups.GPSGroup&&(groups.GPSGroup=new groups.SatGroup("nameRegex",/NAVSTAR/)),void 0===r&&(r=timeManager.propTime());var l=timeManager.jday(r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds());l+=1.15741e-8*r.getUTCMilliseconds();var u=satellite.gstime(l),m={},g=Math.cos(e),c=Math.sin(e),d=Math.cos(t+u),b=Math.sin(t+u);m.x=6371.25*g*d,m.y=6371.25*g*b,m.z=6371.25*c;for(var T=0;T<groups.GPSGroup.sats.length;T++)o=satSet.getSat(groups.GPSGroup.sats[T].satId),n=satellite.ecfToLookAngles({longitude:t,latitude:e,height:s},satellite.eciToEcf(o.position,u)),o.az=n.azimuth*RAD2DEG,o.el=n.elevation*RAD2DEG,o.el>settingsManager.gpsElevationMask&&i.push(o);return satellite.calculateDOPs(i,m,a)}console.error("Longitude Required")}else console.error("Latitude Required")},satellite.calculateDOPs=function(e,t,s){var a={};if(nsat=e.length,nsat<4)return a.PDOP=50,a.HDOP=50,a.GDOP=50,a.VDOP=50,a.TDOP=50,a;var r=numeric.rep([nsat,4],0),o=[],n=[];s&&(drawLineList=[]);for(var i=1;i<=nsat;i++){var l=e[i-1];s&&(drawLineList[i-1]={},drawLineList[i-1].line=new Line,drawLineList[i-1].sat=l,drawLineList[i-1].ref=[t.x,t.y,t.z]);var u=l.az,m=l.el;o.push(u),n.push(m);var g=[Math.cos(m*Math.PI/180)*Math.sin(u*Math.PI/180),Math.cos(m*Math.PI/180)*Math.cos(u*Math.PI/180),Math.sin(m*Math.PI/180),1];numeric.setBlock(r,[i-1,0],[i-1,3],[g])}var c=numeric.dot(numeric.transpose(r),r),d=numeric.inv(c),b=Math.sqrt(d[0][0]+d[1][1]+d[2][2]),T=Math.sqrt(d[0][0]+d[1][1]),p=Math.sqrt(d[0][0]+d[1][1]+d[2][2]+d[3][3]),h=Math.sqrt(d[2][2]),v=Math.sqrt(d[3][3]);return a.PDOP=parseFloat(Math.round(100*b)/100).toFixed(2),a.HDOP=parseFloat(Math.round(100*T)/100).toFixed(2),a.GDOP=parseFloat(Math.round(100*p)/100).toFixed(2),a.VDOP=parseFloat(Math.round(100*h)/100).toFixed(2),a.TDOP=parseFloat(Math.round(100*v)/100).toFixed(2),a},satellite.getSunTimes=function(e,t,o,n){if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd)try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===o&&(o=satellite.lookanglesLength),void 0===n&&(n=satellite.lookanglesInterval);for(var i,l=timeManager.getPropOffset(),u=0,m=satellite.twoline2satrec(e.TLE1,e.TLE2),g=1e11,c=0;c<24*o*60*60;c+=n){u=1e3*c+l;var d=timeManager.propTimeCheck(u,timeManager.propRealTime),b=timeManager.jday(d.getUTCFullYear(),d.getUTCMonth()+1,d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds());b+=d.getUTCMilliseconds()*r;var T,p,h,v,S,C=satellite.gstime(b),x=sun.getDirection2(b),M=1e6*x[0],f=1e6*x[1],z=1e6*x[2],U=(b-m.jdsatepoch)*a,L=satellite.sgp4(m,U),D=Math.pow(M-L.position.x,2),w=Math.pow(f-L.position.y,2),E=Math.pow(z-L.position.z,2),k=Math.sqrt(D+w+E);T=satellite.eciToEcf(L.position,C),p=satellite.ecfToLookAngles(t.observerGd,T),gpos=satellite.eciToGeodetic(L.position,C),alt=1e3*gpos.height,lon=gpos.longitude,lat=gpos.latitude,h=p.azimuth*s,v=p.elevation*s,S=p.rangeSat,t.obsminaz>t.obsmaxaz?((h>=t.obsminaz||h<=t.obsmaxaz)&&v>=t.obsminel&&v<=t.obsmaxel&&S<=t.obsmaxrange&&S>=t.obsminrange||(h>=t.obsminaz2||h<=t.obsmaxaz2)&&v>=t.obsminel2&&v<=t.obsmaxel2&&S<=t.obsmaxrange2&&S>=t.obsminrange2)&&k<g&&(g=k,i=d):(h>=t.obsminaz&&h<=t.obsmaxaz&&v>=t.obsminel&&v<=t.obsmaxel&&S<=t.obsmaxrange&&S>=t.obsminrange||h>=t.obsminaz2&&h<=t.obsmaxaz2&&v>=t.obsminel2&&v<=t.obsmaxel2&&S<=t.obsmaxrange2&&S>=t.obsminrange2)&&k<g&&(g=k,i=d)}console.log("minDistanceApart: "+g),console.log("minDistTime: "+i)},satellite.lookAnglesToEcf=function(e,t,s,a,r,o){var n={};n.latitude=a,n.longitude=r,n.height=o;var i,l,u,m=satellite.geodeticToEcf(n);i=m.x,l=m.y,u=m.z;var g=Math.sin(a),c=Math.sin(r),d=Math.cos(a),b=Math.cos(r),T=DEG2RAD*e,p=DEG2RAD*t,h=-s*Math.cos(p)*Math.cos(T),v=s*Math.cos(p)*Math.sin(T),S=s*Math.sin(p);return{x:g*b*h+-c*v+d*b*S+i,y:g*c*h+b*v+d*c*S+l,z:-d*h+g*S+u}},satellite.xyz2latlon=function(e,t,s){var a=timeManager.propTime(),r=timeManager.jday(a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());r+=1.15741e-8*a.getUTCMilliseconds();var o=satellite.gstime(r),n=satellite.eciToGeodetic({x:e,y:t,z:s},o);return n.latitude=n.latitude*RAD2DEG,n.longitude=n.longitude*RAD2DEG,n.longitude=n.longitude>180?n.longitude-360:n.longitude,n.longitude=n.longitude<-180?n.longitude+360:n.longitude,n},satellite.isInSun=function(e){var t=sun.getXYZ(),s=Math.asin(RADIUS_OF_EARTH/Math.sqrt(Math.pow(-e.position.x,2)+Math.pow(-e.position.y,2)+Math.pow(-e.position.z,2)))*RAD2DEG,a=Math.asin(RADIUS_OF_SUN/Math.sqrt(Math.pow(-e.position.x+t.x,2)+Math.pow(-e.position.y+t.y,2)+Math.pow(-e.position.z+t.z,2)))*RAD2DEG,r=Math.acos(numeric.dot([-e.position.x,-e.position.y,-e.position.z],[-e.position.x+t.x,-e.position.y+t.y,-e.position.z+t.z])/(Math.sqrt(Math.pow(-e.position.x,2)+Math.pow(-e.position.y,2)+Math.pow(-e.position.z,2))*Math.sqrt(Math.pow(-e.position.x+t.x,2)+Math.pow(-e.position.y+t.y,2)+Math.pow(-e.position.z+t.z,2))))*RAD2DEG;return s>a&&r<s-a?0:Math.abs(s-a)<r&&r<s+a?1:a>s?1:r<a-s?1:2},satellite.map=function(e,t){var o=timeManager.getPropOffset(),n=satellite.twoline2satrec(e.TLE1,e.TLE2);return function(e,t){var o=timeManager.propTimeCheck(e,timeManager.propRealTime),n=timeManager.jday(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());n+=o.getUTCMilliseconds()*r;var i,l,u,m=satellite.gstime(n),g=(n-t.jdsatepoch)*a,c=satellite.sgp4(t,g);i=satellite.eciToGeodetic(c.position,m),l=satellite.degreesLat(i.latitude),u=satellite.degreesLong(i.longitude);var d,b,T,p,h,v=timeManager.dateFormat(o,"isoDateTime",!0);d=satellite.eciToEcf(c.position,m),b=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,d),T=b.azimuth*s,p=b.elevation*s,h=b.rangeSat;var S=0;satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz?(T>=satellite.currentSensor.obsminaz&&T<=satellite.currentSensor.obsmaxaz&&p>=satellite.currentSensor.obsminel&&p<=satellite.currentSensor.obsmaxel&&h<=satellite.currentSensor.obsmaxrange&&h>=satellite.currentSensor.obsminrange||T>=satellite.currentSensor.obsminaz2&&T<=satellite.currentSensor.obsmaxaz2&&p>=satellite.currentSensor.obsminel2&&p<=satellite.currentSensor.obsmaxel2&&h<=satellite.currentSensor.obsmaxrange2&&h>=satellite.currentSensor.obsminrange2)&&(S=1):((T>=satellite.currentSensor.obsminaz||T<=satellite.currentSensor.obsmaxaz)&&p>=satellite.currentSensor.obsminel&&p<=satellite.currentSensor.obsmaxel&&h<=satellite.currentSensor.obsmaxrange&&h>=satellite.currentSensor.obsminrange||(T>=satellite.currentSensor.obsminaz2||T<=satellite.currentSensor.obsmaxaz2)&&p>=satellite.currentSensor.obsminel2&&p<=satellite.currentSensor.obsmaxel2&&h<=satellite.currentSensor.obsmaxrange2&&h>=satellite.currentSensor.obsminrange2)&&(S=1);return{lat:l,lon:u,time:v,inview:S}}(t*e.period/50*60*1e3+o,n)}}();
!function(){var e=2*Math.PI,t=e/360,s=360/e,a=1440,r=1.15741e-8;function n(e,t,n){timeManager.propRealTime=Date.now();var o=timeManager.propTimeCheck(e,timeManager.propRealTime),i=timeManager.jday(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());i+=o.getUTCMilliseconds()*r;var l,u,c,m,g,d=satellite.gstime(i),b=(i-n.jdsatepoch)*a,p=satellite.sgp4(n,b);if(l=satellite.eciToEcf(p.position,d),c=(u=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,l)).azimuth*s,m=u.elevation*s,g=u.rangeSat,satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz&&(!(c>=satellite.currentSensor.obsminaz&&c<=satellite.currentSensor.obsmaxaz&&m>=satellite.currentSensor.obsminel&&m<=satellite.currentSensor.obsmaxel&&g<=satellite.currentSensor.obsmaxrange&&g>=satellite.currentSensor.obsminrange)||c>=satellite.currentSensor.obsminaz2&&c<=satellite.currentSensor.obsmaxaz2&&m>=satellite.currentSensor.obsminel2&&m<=satellite.currentSensor.obsmaxel2&&g<=satellite.currentSensor.obsmaxrange2&&g>=satellite.currentSensor.obsminrange2))return 0;if((c>=satellite.currentSensor.obsminaz||c<=satellite.currentSensor.obsmaxaz)&&m>=satellite.currentSensor.obsminel&&m<=satellite.currentSensor.obsmaxel&&g<=satellite.currentSensor.obsmaxrange&&g>=satellite.currentSensor.obsminrange||(c>=satellite.currentSensor.obsminaz2||c<=satellite.currentSensor.obsmaxaz2)&&m>=satellite.currentSensor.obsminel2&&m<=satellite.currentSensor.obsmaxel2&&g<=satellite.currentSensor.obsmaxrange2&&g>=satellite.currentSensor.obsminrange2){if(satellite.isRiseSetLookangles){var T=timeManager.propTimeCheck(e-1e3*satellite.lookanglesInterval,timeManager.propRealTime),h=timeManager.jday(T.getUTCFullYear(),T.getUTCMonth()+1,T.getUTCDate(),T.getUTCHours(),T.getUTCMinutes(),T.getUTCSeconds());h+=T.getUTCMilliseconds()*r;var S,v,C,x,M,f=satellite.gstime(h),z=(h-n.jdsatepoch)*a,L=satellite.sgp4(n,z);if(S=satellite.eciToEcf(L.position,f),C=(v=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,S)).azimuth*s,x=v.elevation*s,M=v.rangeSat,!((c>=satellite.currentSensor.obsminaz||c<=satellite.currentSensor.obsmaxaz)&&m>=satellite.currentSensor.obsminel&&m<=satellite.currentSensor.obsmaxel&&g<=satellite.currentSensor.obsmaxrange&&g>=satellite.currentSensor.obsminrange)||(c>=satellite.currentSensor.obsminaz2||c<=satellite.currentSensor.obsmaxaz2)&&m>=satellite.currentSensor.obsminel2&&m<=satellite.currentSensor.obsmaxel2&&g<=satellite.currentSensor.obsmaxrange2&&g>=satellite.currentSensor.obsminrange2){var U=t.insertRow(),E=U.insertCell();E.appendChild(document.createTextNode(timeManager.dateFormat(o,"isoDateTime",!0)));var w=U.insertCell();w.appendChild(document.createTextNode(m.toFixed(1)));var D=U.insertCell();D.appendChild(document.createTextNode(c.toFixed(0)));var R=U.insertCell();return R.appendChild(document.createTextNode(g.toFixed(0))),1}return T=timeManager.propTimeCheck(e+1e3*satellite.lookanglesInterval,timeManager.propRealTime),h=timeManager.jday(T.getUTCFullYear(),T.getUTCMonth()+1,T.getUTCDate(),T.getUTCHours(),T.getUTCMinutes(),T.getUTCSeconds()),h+=T.getUTCMilliseconds()*r,f=satellite.gstime(h),z=(h-n.jdsatepoch)*a,L=satellite.sgp4(n,z),S=satellite.eciToEcf(L.position,f),C=(v=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,S)).azimuth*s,x=v.elevation*s,M=v.rangeSat,!((C>=satellite.currentSensor.obsminaz||C<=satellite.currentSensor.obsmaxaz)&&x>=satellite.currentSensor.obsminel&&x<=satellite.currentSensor.obsmaxel&&M<=satellite.currentSensor.obsmaxrange&&M>=satellite.currentSensor.obsminrange)||(C>=satellite.currentSensor.obsminaz2||C<=satellite.currentSensor.obsmaxaz2)&&x>=satellite.currentSensor.obsminel2&&x<=satellite.currentSensor.obsmaxel2&&M<=satellite.currentSensor.obsmaxrange2&&M>=satellite.currentSensor.obsminrange2?((E=(U=t.insertRow()).insertCell()).appendChild(document.createTextNode(timeManager.dateFormat(o,"isoDateTime",!0))),(w=U.insertCell()).appendChild(document.createTextNode(m.toFixed(1))),(D=U.insertCell()).appendChild(document.createTextNode(c.toFixed(0))),(R=U.insertCell()).appendChild(document.createTextNode(g.toFixed(0))),1):0}return(E=(U=t.insertRow()).insertCell()).appendChild(document.createTextNode(timeManager.dateFormat(o,"isoDateTime",!0))),(w=U.insertCell()).appendChild(document.createTextNode(m.toFixed(1))),(D=U.insertCell()).appendChild(document.createTextNode(c.toFixed(0))),(R=U.insertCell()).appendChild(document.createTextNode(g.toFixed(0))),1}return 0}function o(e,t,n,o){o=satellite.sensorListUS[o].googleName;var i=Date.now(),l=timeManager.propTimeCheck(e,i),u=timeManager.jday(l.getUTCFullYear(),l.getUTCMonth()+1,l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds());u+=l.getUTCMilliseconds()*r;var c,m,g,d,b,p=satellite.gstime(u),T=(u-n.jdsatepoch)*a,h=satellite.sgp4(n,T);if(c=satellite.eciToEcf(h.position,p),g=(m=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,c)).azimuth*s,d=m.elevation*s,b=m.rangeSat,satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz&&(!(g>=satellite.currentSensor.obsminaz&&g<=satellite.currentSensor.obsmaxaz&&d>=satellite.currentSensor.obsminel&&d<=satellite.currentSensor.obsmaxel&&b<=satellite.currentSensor.obsmaxrange&&b>=satellite.currentSensor.obsminrange)||g>=satellite.currentSensor.obsminaz2&&g<=satellite.currentSensor.obsmaxaz2&&d>=satellite.currentSensor.obsminel2&&d<=satellite.currentSensor.obsmaxel2&&b<=satellite.currentSensor.obsmaxrange2&&b>=satellite.currentSensor.obsminrange2))return 0;if((g>=satellite.currentSensor.obsminaz||g<=satellite.currentSensor.obsmaxaz)&&d>=satellite.currentSensor.obsminel&&d<=satellite.currentSensor.obsmaxel&&b<=satellite.currentSensor.obsmaxrange&&b>=satellite.currentSensor.obsminrange||(g>=satellite.currentSensor.obsminaz2||g<=satellite.currentSensor.obsmaxaz2)&&d>=satellite.currentSensor.obsminel2&&d<=satellite.currentSensor.obsmaxel2&&b<=satellite.currentSensor.obsmaxrange2&&b>=satellite.currentSensor.obsminrange2){var S;if(t.rows.length>0)for(var v=0;v<t.rows.length;v++){var C=t.rows[v].cells[0].textContent,x=parseInt(C.substr(0,4)),M=parseInt(C.substr(5,2))-1,f=parseInt(C.substr(8,2)),z=parseInt(C.substr(11,2)),L=parseInt(C.substr(14,2)),U=parseInt(C.substr(17,2)),E=new Date(x,M,f,z,L,U);if(E.setUTCDate(f),E.setUTCHours(z),l<E){S=t.insertRow(v);break}}return null==S&&(S=t.insertRow()),S.insertCell().appendChild(document.createTextNode(timeManager.dateFormat(l,"isoDateTime",!0))),S.insertCell().appendChild(document.createTextNode(d.toFixed(1))),S.insertCell().appendChild(document.createTextNode(g.toFixed(0))),S.insertCell().appendChild(document.createTextNode(b.toFixed(0))),S.insertCell().appendChild(document.createTextNode(o)),1}return 0}satellite.lookanglesInterval=5,satellite.lookanglesLength=2,satellite.isRiseSetLookangles=!1,satellite.currentSensor={},satellite.tempSensor={},satellite.currentTEARR={},satellite.defaultSensor={},satellite.defaultSensor.observerGd={lat:null,longitude:0,latitude:0,height:0},satellite.currentSensor=satellite.defaultSensor,satellite.sensorListUS=[window.sensorManager.sensorList.COD,window.sensorManager.sensorList.BLE,window.sensorManager.sensorList.CAV,window.sensorManager.sensorList.CLR,window.sensorManager.sensorList.EGL,window.sensorManager.sensorList.FYL,window.sensorManager.sensorList.THL,window.sensorManager.sensorList.MIL,window.sensorManager.sensorList.ALT,window.sensorManager.sensorList.ASC,window.sensorManager.sensorList.CDN],satellite.sensorSelected=function(){return null!=satellite.currentSensor.lat},satellite.currentEpoch=function(e){var t=(e=new Date(e)).getUTCFullYear();t=parseInt(t.toString().substr(2,2));var s=a(timeManager.getDayOfYear(e),3);function a(e,t){return e.length<t?a("0"+e,t):e}return[t,s=a(s=(s+(60*e.getUTCHours()+e.getUTCMinutes())/1440).toFixed(8),12)]},satellite.distance=function(e,t){if(null==t||null==e)return"";if("Star"===t.type||"Star"===e.type)return"";var s=Math.pow(e.position.x-t.position.x,2),a=Math.pow(e.position.y-t.position.y,2),r=Math.pow(e.position.z-t.position.z,2);return"<br />"+Math.sqrt(s+a+r).toFixed(0)+" km"},satellite.getsensorinfo=function(){$("#sensor-latitude").html(satellite.currentSensor.lat),$("#sensor-longitude").html(satellite.currentSensor.long),$("#sensor-minazimuth").html(satellite.currentSensor.obsminaz),$("#sensor-maxazimuth").html(satellite.currentSensor.obsmaxaz),$("#sensor-minelevation").html(satellite.currentSensor.obsminel),$("#sensor-maxelevation").html(satellite.currentSensor.obsmaxel),$("#sensor-minrange").html(satellite.currentSensor.obsminrange),$("#sensor-maxrange").html(satellite.currentSensor.obsmaxrange)},satellite.setobs=function(e,s){if(s)return satellite.currentSensor=satellite.defaultSensor,void $(".sensor-reset-menu").hide();$("#menu-sensor-info").removeClass("bmenu-item-disabled"),$("#menu-fov-bubble").removeClass("bmenu-item-disabled"),$("#menu-surveillance").removeClass("bmenu-item-disabled"),$("#menu-planetarium").removeClass("bmenu-item-disabled"),$("#menu-astronomy").removeClass("bmenu-item-disabled"),$(".sensor-reset-menu").show(),satellite.currentSensor=e,satellite.currentSensor.observerGd={latitude:e.lat*t,longitude:e.long*t,height:1*e.obshei}},satellite.altitudeCheck=function(e,t,s){var n;void 0!==e.TLE1?(s=t,n=satellite.twoline2satrec(e.TLE1,e.TLE2)):n=satellite.twoline2satrec(e,t);var o=timeManager.propTimeCheck(s,timeManager.propRealTime),i=timeManager.jday(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());i+=o.getUTCMilliseconds()*r;var l,u=satellite.gstime(i),c=(i-n.jdsatepoch)*a,m=satellite.sgp4(n,c);try{l=satellite.eciToGeodetic(m.position,u)}catch(e){return 0}return l.height},satellite.getDirection=function(e){var t=satellite.getTEARR(e).lat,s=timeManager.propTimeCheck(5e3,timeManager.propTime()),a=satellite.getTEARR(e,void 0,s).lat;if((t*=RAD2DEG)<(a*=RAD2DEG))return"N";if(t>a)return"S";if(t===a){if(s=timeManager.propTimeCheck(2e4,timeManager.propTime()),futureTEARR=satellite.getTEARR(e,void 0,s),t<a)return"N";if(t>a)return"S"}return console.error("Sat Direction Calculation Error - By Pole?"),"Error"},satellite.getTEARR=function(e,t,n){var o={};if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd){try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}if(void 0===t.observerGd.longitude)try{t.observerGd={height:t.alt,latitude:t.lat*DEG2RAD,longitude:t.lon*DEG2RAD}}catch(e){throw"observerGd is not set and could not be guessed."}}var i,l=satellite.twoline2satrec(e.TLE1,e.TLE2);i=void 0===n?timeManager.propTime():n;var u=timeManager.jday(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds());u+=i.getUTCMilliseconds()*r;var c,m,g,d=satellite.gstime(u),b=(u-l.jdsatepoch)*a,p=satellite.sgp4(l,b);try{g=satellite.eciToGeodetic(p.position,d),o.alt=g.height,o.lon=g.longitude,o.lat=g.latitude,c=satellite.eciToEcf(p.position,d),m=satellite.ecfToLookAngles(t.observerGd,c),o.azimuth=m.azimuth*s,o.elevation=m.elevation*s,o.range=m.rangeSat}catch(e){o.alt=0,o.lon=0,o.lat=0,c=0,m=0,o.azimuth=0,o.elevation=0,o.range=0}return t.obsminaz>t.obsmaxaz?(o.azimuth>=t.obsminaz||o.azimuth<=t.obsmaxaz)&&o.elevation>=t.obsminel&&o.elevation<=t.obsmaxel&&o.range<=t.obsmaxrange&&o.range>=t.obsminrange||(o.azimuth>=t.obsminaz2||o.azimuth<=t.obsmaxaz2)&&o.elevation>=t.obsminel2&&o.elevation<=t.obsmaxel2&&o.range<=t.obsmaxrange2&&o.range>=t.obsminrange2?o.inview=!0:o.inview=!1:o.azimuth>=t.obsminaz&&o.azimuth<=t.obsmaxaz&&o.elevation>=t.obsminel&&o.elevation<=t.obsmaxel&&o.range<=t.obsmaxrange&&o.range>=t.obsminrange||o.azimuth>=t.obsminaz2&&o.azimuth<=t.obsmaxaz2&&o.elevation>=t.obsminel2&&o.elevation<=t.obsmaxel2&&o.range<=t.obsmaxrange2&&o.range>=t.obsminrange2?o.inview=!0:o.inview=!1,satellite.currentTEARR=o,o},satellite.calculateSatrec=function(){console.time("satrecCache");for(var e,t=[],s=0;s<satSet.getSatData().length;s++)sat=satSet.getSat(s),sat.static||sat.missile||!sat.active||(e=satellite.twoline2satrec(sat.TLE1,sat.TLE2),t.push({SCC_NUM:sat.SCC_NUM,satrec:e}));window.satrecCache=t,console.timeEnd("satrecCache")},satellite.nextpassList=function(e){for(var t=[],s=0;s<e.length;s++)for(var a=satellite.next5passes(e[s],void 0,864e5),r=0;r<a.length;r++)t.push({SCC_NUM:e[s].SCC_NUM,time:a[r]});return t},satellite.nextpass=function(e,t,n,o){if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd)try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===n&&(n=satellite.lookanglesLength),void 0===o&&(o=satellite.lookanglesInterval);for(var i=timeManager.getPropOffset(),l=0,u=satellite.twoline2satrec(e.TLE1,e.TLE2),c=0;c<24*n*60*60;c+=o){l=1e3*c+i;var m=timeManager.propTimeCheck(l,timeManager.propRealTime),g=timeManager.jday(m.getUTCFullYear(),m.getUTCMonth()+1,m.getUTCDate(),m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds());g+=m.getUTCMilliseconds()*r;var d,b,p,T,h,S=satellite.gstime(g),v=(g-u.jdsatepoch)*a,C=satellite.sgp4(u,v);if(d=satellite.eciToEcf(C.position,S),p=(b=satellite.ecfToLookAngles(t.observerGd,d)).azimuth*s,T=b.elevation*s,h=b.rangeSat,t.obsminaz>t.obsmaxaz){if((p>=t.obsminaz||p<=t.obsmaxaz)&&T>=t.obsminel&&T<=t.obsmaxel&&h<=t.obsmaxrange&&h>=t.obsminrange||(p>=t.obsminaz2||p<=t.obsmaxaz2)&&T>=t.obsminel2&&T<=t.obsmaxel2&&h<=t.obsmaxrange2&&h>=t.obsminrange2)return timeManager.dateFormat(m,"isoDateTime",!0)}else if(p>=t.obsminaz&&p<=t.obsmaxaz&&T>=t.obsminel&&T<=t.obsmaxel&&h<=t.obsmaxrange&&h>=t.obsminrange||p>=t.obsminaz2&&p<=t.obsmaxaz2&&T>=t.obsminel2&&T<=t.obsmaxel2&&h<=t.obsmaxrange2&&h>=t.obsminrange2)return timeManager.dateFormat(m,"isoDateTime",!0)}return"No Passes in "+satellite.lookanglesLength+" Days"},satellite.next5passes=function(t,n,o,i){if(void 0===n){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";n=satellite.currentSensor}if(void 0===n.observerGd)try{n.observerGd={height:n.obshei,latitude:n.lat,longitude:n.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===o&&(o=satellite.lookanglesLength),void 0===i&&(i=satellite.lookanglesInterval);for(var l=[],u=timeManager.getPropOffset(),c=0,m=satellite.twoline2satrec(t.TLE1,t.TLE2),g=a/(m.no*a/e),d=0;d<24*o*60*60;d+=i){if(l.length>=5)return l;c=1e3*d+u;var b=timeManager.propTimeCheck(c,timeManager.propRealTime),p=timeManager.jday(b.getUTCFullYear(),b.getUTCMonth()+1,b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds());p+=b.getUTCMilliseconds()*r;var T,h,S,v,C,x=satellite.gstime(p),M=(p-m.jdsatepoch)*a,f=satellite.sgp4(m,M);T=satellite.eciToEcf(f.position,x),S=(h=satellite.ecfToLookAngles(n.observerGd,T)).azimuth*s,v=h.elevation*s,C=h.rangeSat,n.obsminaz>n.obsmaxaz?((S>=n.obsminaz||S<=n.obsmaxaz)&&v>=n.obsminel&&v<=n.obsmaxel&&C<=n.obsmaxrange&&C>=n.obsminrange||(S>=n.obsminaz2||S<=n.obsmaxaz2)&&v>=n.obsminel2&&v<=n.obsmaxel2&&C<=n.obsmaxrange2&&C>=n.obsminrange2)&&(l.push(b),d+=60*g*.75):(S>=n.obsminaz&&S<=n.obsmaxaz&&v>=n.obsminel&&v<=n.obsmaxel&&C<=n.obsmaxrange&&C>=n.obsminrange||S>=n.obsminaz2&&S<=n.obsmaxaz2&&v>=n.obsminel2&&v<=n.obsmaxel2&&C<=n.obsmaxrange2&&C>=n.obsminrange2)&&(l.push(b),d+=60*g*.75)}return l},satellite.getlookanglesMultiSite=function(t,s){if(s){var r=!1;satellite.sensorSelected()||(r=!0);var n=timeManager.getPropOffset();satellite.tempSensor=satellite.currentSensor,satellite.setobs(satellite.sensorListUS[0]);var i=satellite.twoline2satrec(t.TLE1,t.TLE2),l=a/(i.no*a/e),u=document.getElementById("looksmultisite");u.innerHTML="";var c=0,m=0,g=0,d=6,b=u.insertRow(),p=b.insertCell();p.appendChild(document.createTextNode("Time")),p.setAttribute("style","text-decoration: underline");var T=b.insertCell();T.appendChild(document.createTextNode("El")),T.setAttribute("style","text-decoration: underline");var h=b.insertCell();h.appendChild(document.createTextNode("Az")),h.setAttribute("style","text-decoration: underline");var S=b.insertCell();S.appendChild(document.createTextNode("Rng")),S.setAttribute("style","text-decoration: underline");var v=b.insertCell();v.appendChild(document.createTextNode("Sensor")),v.setAttribute("style","text-decoration: underline");for(var C=0;C<24*satellite.lookanglesLength*60*60;C+=satellite.lookanglesInterval){if((c+=o(1e3*C+n,u,i,g))>m&&(m++,1===d?(g++,satellite.setobs(satellite.sensorListUS[g]),C=0,d=6):(d-=1,C+=60*l*.75)),g===satellite.sensorListUS.length-1){satellite.currentSensor=r?satellite.defaultSensor:satellite.tempSensor;break}g<satellite.sensorListUS.length-1&&C>=24*satellite.lookanglesLength*60*60-satellite.lookanglesInterval&&(g++,satellite.setobs(satellite.sensorListUS[g]),C=0,d=6)}satellite.currentSensor=r?satellite.defaultSensor:satellite.tempSensor}},satellite.getOrbitByLatLon=function(e,t,n,o,i,l){var u,c,m,g,d,b,p,T,h,S,v;for(v=0;v<5200;v+=1){if(1===(p=z(v,!1))){if(S===o){T=v;break}v+=20}5===p&&(v+=100)}if(console.log(`meanACalcResults: ${p} - ${T}`),2===p)return console.warn("meanACalcResults failed after trying all combinations!"),["Error",""];if(void 0!==l)for(p=0,v=0;v<3600;v+=1){if(1===(b=f(v))){if(1===p&&S===o)break}else console.log("Failed Arg of Per Calc");if(5===b&&(v+=50),2===b)return["Error",""];for(var C=0;C<5200;C+=1){if(1===(p=z(C,!1))){if(S===o)break;C+=20}if(5===p&&(C+=100),2===p)return["Error",""]}}for(v=0;v<52e4;v+=1){0;var x=L(v);if(1===x)break;5===x&&(v+=1e3)}return[u,c];function M(e,t){return e.length<t?M("0"+e,t):e}function f(t){var a,r,n=satellite.twoline2satrec(e.TLE1,e.TLE2);(a=(a=void 0===m?(n.mo*s).toPrecision(10):m).split("."))[0]=a[0].substr(-3,3),a[1]=a[1].substr(0,4),a=M(a=(a[0]+"."+a[1]).toString(),8),(r=(r=void 0===g?(e.raan*s).toPrecision(7):g).split("."))[0]=r[0].substr(-3,3),r[1]=r[1].substr(0,4),r=M(r=(r[0]+"."+r[1]).toString(),8),g=r;var o=e.SCC_NUM,l=e.TLE1.substr(9,8),b=(e.inclination*s).toPrecision(7);(b=b.split("."))[0]=b[0].substr(-3,3),b[1]=b[1].substr(0,4),b=M(b=(b[0]+"."+b[1]).toString(),8);var p=e.TLE1.substr(18,2),T=e.TLE1.substr(20,12),h=e.TLE2.substr(52,11),S=e.eccentricity.toPrecision(7).substr(2,7);t/=10,t=M(t=parseFloat(t).toPrecision(7),8);var v=e.TLE1.substr(32,39);u="1 "+o+"U "+l+" "+p+T+v,c="2 "+o+" "+b+" "+r+" "+S+" "+t+" "+a+" "+h+"    10",n=satellite.twoline2satrec(u,c);var C=U(i,n,3);return e.TLE1=u,e.TLE2=c,d=t,C}function z(t,a){var r=satellite.twoline2satrec(e.TLE1,e.TLE2);t/=10,t=M(t=parseFloat(t).toPrecision(7),8);var n=(e.raan*s).toPrecision(7);g=n,(n=n.toString().split("."))[0]=n[0].substr(-3,3),n[1]=n[1].substr(0,4),n=M(n=(n[0]+"."+n[1]).toString(),8);var o=e.SCC_NUM,l=e.TLE1.substr(9,8),b=(e.inclination*s).toPrecision(7);(b=b.split("."))[0]=b[0].substr(-3,3),b[1]=b[1].substr(0,4),b=M(b=(b[0]+"."+b[1]).toString(),8);var p,T=e.TLE1.substr(18,2),h=e.TLE1.substr(20,12),S=e.TLE2.substr(52,11),v=e.eccentricity.toPrecision(7).substr(2,7);(p=(p=void 0===d?(e.argPe*s).toPrecision(7):d).split("."))[0]=p[0].substr(-3,3),p[1]=p[1].substr(0,4),p=M(p=(p[0]+"."+p[1]).toString(),8);var C="1 "+o+"U "+l+" "+T+h+e.TLE1.substr(32,39),x="2 "+o+" "+b+" "+n+" "+v+" "+p+" "+t+" "+S+"    10";r=satellite.twoline2satrec(C,x);var f=U(i,r,1);return 1===f&&(u=C,c=x,e.TLE1=C,e.TLE2=x,m=t),f}function L(t){var a=satellite.twoline2satrec(e.TLE1,e.TLE2),r=m;(t/=100)>360&&(t-=360),(t=(t=t.toPrecision(7)).split("."))[0]=t[0].substr(-3,3),t[1]=t[1].substr(0,4),t=M(t=(t[0]+"."+t[1]).toString(),8),g=t;var n=e.SCC_NUM,o=e.TLE1.substr(9,8),l=(e.inclination*s).toPrecision(7);(l=l.split("."))[0]=l[0].substr(-3,3),l[1]=l[1].substr(0,4),l=M(l=(l[0]+"."+l[1]).toString(),8);var b,p=e.TLE1.substr(18,2),T=e.TLE1.substr(20,12),h=e.TLE2.substr(52,11),S=e.eccentricity.toPrecision(7).substr(2,7);(b=(b=void 0===d?(e.argPe*s).toPrecision(7):d).split("."))[0]=b[0].substr(-3,3),b[1]=b[1].substr(0,4),b=M(b=(b[0]+"."+b[1]).toString(),8);var v=e.TLE1.substr(32,39);u="1 "+n+"U "+o+" "+p+T+v,c="2 "+n+" "+l+" "+t+" "+S+" "+b+" "+r+" "+h+"    10",a=satellite.twoline2satrec(u,c);var C=U(i,a,2);return 1===C&&(e.TLE1=u,e.TLE2=c),C}function U(e,s,o){timeManager.propRealTime=Date.now();var i=timeManager.propTimeCheck(e,timeManager.propRealTime),u=timeManager.jday(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds());u+=i.getUTCMilliseconds()*r;var c,m,g,d,b=satellite.gstime(u),p=(u-s.jdsatepoch)*a,T=satellite.sgp4(s,p);void 0===T&&console.log(s);try{c=satellite.eciToGeodetic(T.position,b)}catch(e){return console.warn(e),2}if(m=1*satellite.degreesLat(c.latitude),g=1*satellite.degreesLong(c.longitude),d=c.height,null==h&&(h=m),1===o){if(m===h)return 0;m>h&&(S="N"),m<h&&(S="S"),h=m}return m>t-.15&&m<t+.15&&1===o?1:g>n-.15&&g<n+.15&&2===o?1:d>l-30&&d<l+30&&3===o?1:(m>t-11&&m<t+11||1!==o)&&(g>n-11&&g<n+11||2!==o)?(d<l-100||d>l+100)&&3===o?5:0:5}},satellite.getlookangles=function(e,t){if(t&&satellite.sensorSelected()){var s=0,a=timeManager.getPropOffset(),r=satellite.twoline2satrec(e.TLE1,e.TLE2),o=document.getElementById("looks");o.innerHTML="";var i=0,l=o.insertRow(),u=l.insertCell();u.appendChild(document.createTextNode("Time")),u.setAttribute("style","text-decoration: underline");var c=l.insertCell();c.appendChild(document.createTextNode("El")),c.setAttribute("style","text-decoration: underline");var m=l.insertCell();m.appendChild(document.createTextNode("Az")),m.setAttribute("style","text-decoration: underline");var g=l.insertCell();if(g.appendChild(document.createTextNode("Rng")),g.setAttribute("style","text-decoration: underline"),satellite.isRiseSetLookangles){var d=satellite.lookanglesInterval;satellite.lookanglesInterval=1}for(var b=0;b<24*satellite.lookanglesLength*60*60&&(s=1e3*b+a,!(i>=1500));b+=satellite.lookanglesInterval)i+=n(s,o,r);satellite.isRiseSetLookangles&&(satellite.lookanglesInterval=d)}},satellite.getDOPsTable=function(e,t,s){var a,r=document.getElementById("dops");r.innerHTML="";var n=timeManager.getPropOffset(),o=0,i=r.insertRow(),l=i.insertCell();l.appendChild(document.createTextNode("Time"));var u=i.insertCell();u.appendChild(document.createTextNode("HDOP"));var c=i.insertCell();c.appendChild(document.createTextNode("PDOP"));var m=i.insertCell();m.appendChild(document.createTextNode("GDOP"));for(var g=0;g<1440;g++)o=1e3*g*60+n,a=timeManager.propTimeCheck(o,timeManager.propRealTime),dops=satellite.getDOPs(e,t,s,!1,a),(l=(i=r.insertRow()).insertCell()).appendChild(document.createTextNode(timeManager.dateFormat(a,"isoDateTime",!0))),(u=i.insertCell()).appendChild(document.createTextNode(dops.HDOP)),(c=i.insertCell()).appendChild(document.createTextNode(dops.PDOP)),(m=i.insertCell()).appendChild(document.createTextNode(dops.GDOP))},satellite.getDOPs=function(e,t,s,a,r){if(void 0!==e){if(void 0!==t){var n,o;s=void 0!==s?s:0,a=void 0!==a&&a,e*=DEG2RAD,t*=DEG2RAD;var i=[];void 0===groups.GPSGroup&&(groups.GPSGroup=new groups.SatGroup("nameRegex",/NAVSTAR/)),void 0===r&&(r=timeManager.propTime());var l=timeManager.jday(r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds());l+=1.15741e-8*r.getUTCMilliseconds();var u=satellite.gstime(l),c={},m=Math.cos(e),g=Math.sin(e),d=Math.cos(t+u),b=Math.sin(t+u);c.x=6371.25*m*d,c.y=6371.25*m*b,c.z=6371.25*g;for(var p=0;p<groups.GPSGroup.sats.length;p++)n=satSet.getSat(groups.GPSGroup.sats[p].satId),o=satellite.ecfToLookAngles({longitude:t,latitude:e,height:s},satellite.eciToEcf(n.position,u)),n.az=o.azimuth*RAD2DEG,n.el=o.elevation*RAD2DEG,n.el>settingsManager.gpsElevationMask&&i.push(n);return satellite.calculateDOPs(i,c,a)}console.error("Longitude Required")}else console.error("Latitude Required")},satellite.calculateDOPs=function(e,t,s){var a={};if(nsat=e.length,nsat<4)return a.PDOP=50,a.HDOP=50,a.GDOP=50,a.VDOP=50,a.TDOP=50,a;var r=numeric.rep([nsat,4],0),n=[],o=[];s&&(drawLineList=[]);for(var i=1;i<=nsat;i++){var l=e[i-1];s&&(drawLineList[i-1]={},drawLineList[i-1].line=new Line,drawLineList[i-1].sat=l,drawLineList[i-1].ref=[t.x,t.y,t.z]);var u=l.az,c=l.el;n.push(u),o.push(c);var m=[Math.cos(c*Math.PI/180)*Math.sin(u*Math.PI/180),Math.cos(c*Math.PI/180)*Math.cos(u*Math.PI/180),Math.sin(c*Math.PI/180),1];numeric.setBlock(r,[i-1,0],[i-1,3],[m])}var g=numeric.dot(numeric.transpose(r),r),d=numeric.inv(g),b=Math.sqrt(d[0][0]+d[1][1]+d[2][2]),p=Math.sqrt(d[0][0]+d[1][1]),T=Math.sqrt(d[0][0]+d[1][1]+d[2][2]+d[3][3]),h=Math.sqrt(d[2][2]),S=Math.sqrt(d[3][3]);return a.PDOP=parseFloat(Math.round(100*b)/100).toFixed(2),a.HDOP=parseFloat(Math.round(100*p)/100).toFixed(2),a.GDOP=parseFloat(Math.round(100*T)/100).toFixed(2),a.VDOP=parseFloat(Math.round(100*h)/100).toFixed(2),a.TDOP=parseFloat(Math.round(100*S)/100).toFixed(2),a},satellite.getSunTimes=function(e,t,n,o){if(void 0===t){if(void 0===satellite.currentSensor)throw"getTEARR requires a sensor or for a sensor to be currently selected.";t=satellite.currentSensor}if(void 0===t.observerGd)try{t.observerGd={height:t.obshei,latitude:t.lat,longitude:t.long}}catch(e){throw"observerGd is not set and could not be guessed."}void 0===n&&(n=satellite.lookanglesLength),void 0===o&&(o=satellite.lookanglesInterval);for(var i,l=timeManager.getPropOffset(),u=0,c=satellite.twoline2satrec(e.TLE1,e.TLE2),m=1e11,g=0;g<24*n*60*60;g+=o){u=1e3*g+l;var d=timeManager.propTimeCheck(u,timeManager.propRealTime),b=timeManager.jday(d.getUTCFullYear(),d.getUTCMonth()+1,d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds());b+=d.getUTCMilliseconds()*r;var p,T,h,S,v,C=satellite.gstime(b),x=sun.getDirection2(b),M=1e6*x[0],f=1e6*x[1],z=1e6*x[2],L=(b-c.jdsatepoch)*a,U=satellite.sgp4(c,L),E=Math.pow(M-U.position.x,2),w=Math.pow(f-U.position.y,2),D=Math.pow(z-U.position.z,2),R=Math.sqrt(E+w+D);p=satellite.eciToEcf(U.position,C),T=satellite.ecfToLookAngles(t.observerGd,p),gpos=satellite.eciToGeodetic(U.position,C),alt=1e3*gpos.height,lon=gpos.longitude,lat=gpos.latitude,h=T.azimuth*s,S=T.elevation*s,v=T.rangeSat,t.obsminaz>t.obsmaxaz?((h>=t.obsminaz||h<=t.obsmaxaz)&&S>=t.obsminel&&S<=t.obsmaxel&&v<=t.obsmaxrange&&v>=t.obsminrange||(h>=t.obsminaz2||h<=t.obsmaxaz2)&&S>=t.obsminel2&&S<=t.obsmaxel2&&v<=t.obsmaxrange2&&v>=t.obsminrange2)&&R<m&&(m=R,i=d):(h>=t.obsminaz&&h<=t.obsmaxaz&&S>=t.obsminel&&S<=t.obsmaxel&&v<=t.obsmaxrange&&v>=t.obsminrange||h>=t.obsminaz2&&h<=t.obsmaxaz2&&S>=t.obsminel2&&S<=t.obsmaxel2&&v<=t.obsmaxrange2&&v>=t.obsminrange2)&&R<m&&(m=R,i=d)}console.log("minDistanceApart: "+m),console.log("minDistTime: "+i)},satellite.lookAnglesToEcf=function(e,t,s,a,r,n){var o={};o.latitude=a,o.longitude=r,o.height=n;var i,l,u,c=satellite.geodeticToEcf(o);i=c.x,l=c.y,u=c.z;var m=Math.sin(a),g=Math.sin(r),d=Math.cos(a),b=Math.cos(r),p=DEG2RAD*e,T=DEG2RAD*t,h=-s*Math.cos(T)*Math.cos(p),S=s*Math.cos(T)*Math.sin(p),v=s*Math.sin(T);return{x:m*b*h+-g*S+d*b*v+i,y:m*g*h+b*S+d*g*v+l,z:-d*h+m*v+u}},satellite.xyz2latlon=function(e,t,s){var a=timeManager.propTime(),r=timeManager.jday(a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());r+=1.15741e-8*a.getUTCMilliseconds();var n=satellite.gstime(r),o=satellite.eciToGeodetic({x:e,y:t,z:s},n);return o.latitude=o.latitude*RAD2DEG,o.longitude=o.longitude*RAD2DEG,o.longitude=o.longitude>180?o.longitude-360:o.longitude,o.longitude=o.longitude<-180?o.longitude+360:o.longitude,o},satellite.isInSun=function(e){var t=sun.getXYZ(),s=Math.asin(RADIUS_OF_EARTH/Math.sqrt(Math.pow(-e.position.x,2)+Math.pow(-e.position.y,2)+Math.pow(-e.position.z,2)))*RAD2DEG,a=Math.asin(RADIUS_OF_SUN/Math.sqrt(Math.pow(-e.position.x+t.x,2)+Math.pow(-e.position.y+t.y,2)+Math.pow(-e.position.z+t.z,2)))*RAD2DEG,r=Math.acos(numeric.dot([-e.position.x,-e.position.y,-e.position.z],[-e.position.x+t.x,-e.position.y+t.y,-e.position.z+t.z])/(Math.sqrt(Math.pow(-e.position.x,2)+Math.pow(-e.position.y,2)+Math.pow(-e.position.z,2))*Math.sqrt(Math.pow(-e.position.x+t.x,2)+Math.pow(-e.position.y+t.y,2)+Math.pow(-e.position.z+t.z,2))))*RAD2DEG;return s>a&&r<s-a?0:Math.abs(s-a)<r&&r<s+a?1:a>s?1:r<a-s?1:2},satellite.map=function(e,t){var n=timeManager.getPropOffset(),o=satellite.twoline2satrec(e.TLE1,e.TLE2);return function(e,t){var n=timeManager.propTimeCheck(e,timeManager.propRealTime),o=timeManager.jday(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());o+=n.getUTCMilliseconds()*r;var i,l,u,c=satellite.gstime(o),m=(o-t.jdsatepoch)*a,g=satellite.sgp4(t,m);i=satellite.eciToGeodetic(g.position,c),l=satellite.degreesLat(i.latitude),u=satellite.degreesLong(i.longitude);var d,b,p,T,h,S=timeManager.dateFormat(n,"isoDateTime",!0);d=satellite.eciToEcf(g.position,c),b=satellite.ecfToLookAngles(satellite.currentSensor.observerGd,d),p=b.azimuth*s,T=b.elevation*s,h=b.rangeSat;var v=0;satellite.currentSensor.obsminaz<satellite.currentSensor.obsmaxaz?(p>=satellite.currentSensor.obsminaz&&p<=satellite.currentSensor.obsmaxaz&&T>=satellite.currentSensor.obsminel&&T<=satellite.currentSensor.obsmaxel&&h<=satellite.currentSensor.obsmaxrange&&h>=satellite.currentSensor.obsminrange||p>=satellite.currentSensor.obsminaz2&&p<=satellite.currentSensor.obsmaxaz2&&T>=satellite.currentSensor.obsminel2&&T<=satellite.currentSensor.obsmaxel2&&h<=satellite.currentSensor.obsmaxrange2&&h>=satellite.currentSensor.obsminrange2)&&(v=1):((p>=satellite.currentSensor.obsminaz||p<=satellite.currentSensor.obsmaxaz)&&T>=satellite.currentSensor.obsminel&&T<=satellite.currentSensor.obsmaxel&&h<=satellite.currentSensor.obsmaxrange&&h>=satellite.currentSensor.obsminrange||(p>=satellite.currentSensor.obsminaz2||p<=satellite.currentSensor.obsmaxaz2)&&T>=satellite.currentSensor.obsminel2&&T<=satellite.currentSensor.obsmaxel2&&h<=satellite.currentSensor.obsmaxrange2&&h>=satellite.currentSensor.obsminrange2)&&(v=1);return{lat:l,lon:u,time:S,inview:v}}(t*e.period/50*60*1e3+n,o)}}();
!function(){var e,a,t=settingsManager.colors,r=-1,o=function(e){this.colorizer=e,this.colorBuf=gl.createBuffer(),this.pickableBuf=gl.createBuffer()};o.objectTypeFlags={},o.resetObjectTypeFlags=(()=>{o.objectTypeFlags.payload=!0,o.objectTypeFlags.radarData=!0,o.objectTypeFlags.rocketBody=!0,o.objectTypeFlags.debris=!0,o.objectTypeFlags.facility=!0,o.objectTypeFlags.sensor=!0,o.objectTypeFlags.missile=!0,o.objectTypeFlags.trusat=!0,o.objectTypeFlags.inFOV=!0,o.objectTypeFlags.inviewAlt=!0,o.objectTypeFlags.starLow=!0,o.objectTypeFlags.starMed=!0,o.objectTypeFlags.starHi=!0,o.objectTypeFlags.satLEO=!0,o.objectTypeFlags.satGEO=!0,o.objectTypeFlags.satLow=!0,o.objectTypeFlags.satMed=!0,o.objectTypeFlags.satHi=!0,o.objectTypeFlags.satSmall=!0,o.objectTypeFlags.rcsSmall=!0,o.objectTypeFlags.rcsMed=!0,o.objectTypeFlags.rcsLarge=!0,o.objectTypeFlags.rcsUnknown=!0,o.objectTypeFlags.velocitySlow=!0,o.objectTypeFlags.velocityMed=!0,o.objectTypeFlags.velocityFast=!0,o.objectTypeFlags.ageNew=!0,o.objectTypeFlags.ageMed=!0,o.objectTypeFlags.ageOld=!0,o.objectTypeFlags.ageLost=!0}),o.resetObjectTypeFlags(),o.prototype.calculateColorBuffers=function(a,t){var o,c,l,i,s,n=0,p=Date.now();if(l&&c||(this.lastCalculation=p,o=satSet.numSats,c=new Float32Array(4*o),l=new Float32Array(o)),!a&&p-n<settingsManager.reColorMinimumTime&&0!==n)return{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf};n=p;var b,g=satSet.getSatData(),y=satSet.getSatInView();for(this.isVelocityColorScheme&&(satVel=satSet.getSatVel()),r=-1,settingsManager.isFOVBubbleModeOn||settingsManager.isShowSurvFence||settingsManager.isSatOverflyModeOn||(o-=settingsManager.maxFieldOfViewMarkers),this.default,this.isSunlightColorScheme&&(b=satSet.getSatInSun()),s=0;s<o;s++)if(e=g[s],y&&(e.inView=y[s]),b&&(e.inSun=b[s]),this.isVelocityColorScheme&&(e.velocity=Math.sqrt(satVel[3*s]*satVel[3*s]+satVel[3*s+1]*satVel[3*s+1]+satVel[3*s+2]*satVel[3*s+2])),void 0!==(i=this.colorizer(e))){try{c[4*s]=i.color[0],c[4*s+1]=i.color[1],c[4*s+2]=i.color[2],c[4*s+3]=i.color[3],l[s]=i.pickable?1:0}catch(e){db.enabled&&db.log(satSet.getSat(s));continue}s==objectManager.selectedSat&&(c[4*s]=settingsManager.selectedColor[0],c[4*s+1]=settingsManager.selectedColor[1],c[4*s+2]=settingsManager.selectedColor[2],c[4*s+3]=settingsManager.selectedColor[3]);try{s==objectManager.hoveringSat&&(c[4*s]=settingsManager.hoverColor[0],c[4*s+1]=settingsManager.hoverColor[1],c[4*s+2]=settingsManager.hoverColor[2],c[4*s+3]=settingsManager.hoverColor[3])}catch(e){}}return gl.bindBuffer(gl.ARRAY_BUFFER,this.colorBuf),gl.bufferData(gl.ARRAY_BUFFER,c,gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this.pickableBuf),gl.bufferData(gl.ARRAY_BUFFER,l,gl.STATIC_DRAW),{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf}},o.reloadColors=function(){t=settingsManager.colors},o.init=function(){(o.default=new o(function(e){return!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type||!1!==o.objectTypeFlags.facility?!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static&&"Star"===e.type?e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:e.marker?(e.id===satSensorMarkerArray[r+1]&&r++,r>=0?{color:t.marker[r],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1}):e.isRadarData&&!o.objectTypeFlags.radarData?{color:t.deselected,pickable:!1}:e.isRadarData?e.missileComplex>=0?{color:t.radarDataMissile,pickable:!0}:e.satId>=0?{color:t.radarDataSatellite,pickable:!0}:{color:t.radarData,pickable:!0}:e.static&&!1===o.objectTypeFlags.sensor?{color:t.deselected,pickable:!1}:e.static?{color:t.sensor,pickable:!0}:e.missile&&!e.inView?{color:t.missile,pickable:!0}:e.missile&&e.inView?{color:t.missileInview,pickable:!0}:!e.inView&&1===e.OT&&!1===o.objectTypeFlags.payload||cameraType.current===cameraType.PLANETARIUM&&1===e.OT&&!1===o.objectTypeFlags.payload||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&1===e.OT&&!1===o.objectTypeFlags.payload?{color:t.deselected,pickable:!1}:!e.inView&&2===e.OT&&!1===o.objectTypeFlags.rocketBody||cameraType.current===cameraType.PLANETARIUM&&2===e.OT&&!1===o.objectTypeFlags.rocketBody||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&2===e.OT&&!1===o.objectTypeFlags.rocketBody?{color:t.deselected,pickable:!1}:!e.inView&&3===e.OT&&!1===o.objectTypeFlags.debris||cameraType.current===cameraType.PLANETARIUM&&3===e.OT&&!1===o.objectTypeFlags.debris||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&3===e.OT&&!1===o.objectTypeFlags.debris?{color:t.deselected,pickable:!1}:!e.inView&&4===e.OT&&!1===o.objectTypeFlags.trusat||cameraType.current===cameraType.PLANETARIUM&&4===e.OT&&!1===o.objectTypeFlags.trusat||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&4===e.OT&&!1===o.objectTypeFlags.trusat?{color:t.deselected,pickable:!1}:cameraType.current===cameraType.ASTRONOMY?{color:t.deselected,pickable:!1}:e.inView&&!1===o.objectTypeFlags.inFOV&&cameraType.current!==cameraType.PLANETARIUM?{color:t.deselected,pickable:!1}:!e.inView||cameraType.current===cameraType.PLANETARIUM||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag?(a="ANALSAT"===e.C?t.analyst:1===e.OT?t.payload:2===e.OT?t.rocketBody:3===e.OT?t.debris:4===e.OT?t.trusat:t.unknown,e.perigee>satellite.obsmaxrange||e.apogee<satellite.obsminrange?{color:t.transparent,pickable:!1}:void 0===a?(console.warn(e.id),{color:t.transparent,pickable:!1}):{color:a,pickable:!0}):{color:t.inview,pickable:!0}:{color:t.facility,pickable:!0}:{color:t.deselected,pickable:!1}})).default=!0,o.onlyFOV=new o(function(e){return e.inView?{color:t.inview,pickable:!0}:{color:t.transparent,pickable:!1}}),(o.sunlight=new o(function(e){if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type)&&!1===o.objectTypeFlags.facility)return{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static&&"Star"===e.type)return e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.marker)return e.id===satSensorMarkerArray[r+1]&&r++,r>=0?{color:t.marker[r],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1};if(e.static&&!1===o.objectTypeFlags.sensor)return{color:t.deselected,pickable:!1};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile&&!e.inView)return{color:t.missile,pickable:!0};if(e.missile&&e.inView)return{color:t.missileInview,pickable:!0};if(e.inView&&e.inSun>0&&!0===o.objectTypeFlags.inFOV)return void 0===e.vmag?{color:t.deselected,pickable:!1}:{color:t.sunlightInview,pickable:!0};if(!e.inView&&void 0!==e.vmag){if(2==e.inSun&&!0===o.objectTypeFlags.satHi){if(e.vmag<3)return{color:t.starHi,pickable:!1};if(e.vmag<=4.5)return{color:t.starMed,pickable:!1};if(e.vmag>4.5)return{color:t.starLow,pickable:!1}}return 0==e.inSun&&!0===o.objectTypeFlags.satLow?{color:t.umbral,pickable:!1}:1==e.inSun&&!0===o.objectTypeFlags.satMed?{color:t.penumbral,pickable:!0}:{color:t.umbral,pickable:!1}}return{color:t.deselected,pickable:!1}})).isSunlightColorScheme=!0,o.apogee=new o(function(e){var a=e.apogee;return t.gradientAmt=Math.min(a/45e3,1),t.apogeeGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.apogeeGradient,pickable:!0}}),o.smallsats=new o(function(e){return 1===e.OT&&!1===o.objectTypeFlags.satSmall?{color:t.deselected,pickable:!1}:e.R<.1&&1===e.OT?{color:t.satSmall,pickable:!0}:{color:t.transparent,pickable:!1}}),o.rcs=new o(function(e){var a=e.R;return a<.1&&!1===o.objectTypeFlags.rcsSmall?{color:t.deselected,pickable:!1}:a>=.1&&a<=1&&!1===o.objectTypeFlags.rcsMed?{color:t.deselected,pickable:!1}:a>1&&!1===o.objectTypeFlags.rcsLarge?{color:t.deselected,pickable:!1}:void 0!==a&&null!=typeof a&&"N/A"!=a||!1!==o.objectTypeFlags.rcsUnknown?a<.1?{color:t.rcsSmall,pickable:!0}:a>=.1&&a<=1?{color:t.rcsMed,pickable:!0}:a>1?{color:t.rcsLarge,pickable:!0}:{color:t.rcsUnknown,pickable:!0}:{color:t.deselected,pickable:!1}}),o.countries=new o(function(e){var a=e.C;return"US"===a&&!1===o.objectTypeFlags.countryUS||cameraType.current===cameraType.PLANETARIUM&&"US"===a&&!1===o.objectTypeFlags.countryUS?{color:t.deselected,pickable:!1}:"PRC"===a&&!1===o.objectTypeFlags.countryPRC||cameraType.current===cameraType.PLANETARIUM&&"PRC"===a&&!1===o.objectTypeFlags.countryPRC?{color:t.deselected,pickable:!1}:"CIS"===a&&!1===o.objectTypeFlags.countryCIS||cameraType.current===cameraType.PLANETARIUM&&"CIS"===a&&!1===o.objectTypeFlags.countryCIS?{color:t.deselected,pickable:!1}:"US"===a?{color:t.countryUS,pickable:!0}:"PRC"===a?{color:t.countryPRC,pickable:!0}:"CIS"===a?{color:t.countryCIS,pickable:!0}:!1===o.objectTypeFlags.countryOther||cameraType.current===cameraType.PLANETARIUM&&!1===o.objectTypeFlags.countryOther?{color:t.deselected,pickable:!1}:{color:t.countryOther,pickable:!0}}),o.ageOfElset=new o(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,r=new Date,c=timeManager.getDayOfYear(r);return r=(r=r.getFullYear()).toString().substr(2,2),(a=e.TLE1.substr(18,2)===r?c-e.TLE1.substr(20,3):c-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2))<3&&o.objectTypeFlags.ageNew?{color:t.ageNew,pickable:!0}:a>=3&&a<14&&o.objectTypeFlags.ageMed?{color:t.ageMed,pickable:!0}:a>=14&&a<60&&o.objectTypeFlags.ageOld?{color:t.ageOld,pickable:!0}:a>=60&&o.objectTypeFlags.ageLost?{color:t.ageLost,pickable:!0}:{color:t.deselected,pickable:!1}}),o.lostobjects=new o(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,r=e.perigee,c=new Date,l=timeManager.getDayOfYear(c);return c=(c=c.getFullYear()).toString().substr(2,2),a=e.TLE1.substr(18,2)===c?l-e.TLE1.substr(20,3):l-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2),r>satellite.obsmaxrange||a<settingsManager.daysUntilObjectLost?{color:t.transparent,pickable:!1}:(""===$("#search").val()?$("#search").val($("#search").val()+e.SCC_NUM):$("#search").val($("#search").val()+","+e.SCC_NUM),{color:t.lostobjects,pickable:!0})}),o.leo=new o(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.apogee>2e3?{color:t.transparent,pickable:!1}:e.inView&&!0===o.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satLEO,pickable:!0}:{color:t.facility,pickable:!0}}),o.geo=new o(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.perigee<35e3?{color:t.transparent,pickable:!1}:e.inView&&!0===o.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satGEO,pickable:!0}:{color:t.facility,pickable:!0}}),(o.velocity=new o(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&o.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&o.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&o.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};var a=e.velocity;return e.inView?!1===o.objectTypeFlags.inviewAlt?{color:t.deselected,pickable:!1}:{color:t.inviewAlt,pickable:!0}:a>5.5&&!1===o.objectTypeFlags.velocityFast?{color:t.deselected,pickable:!1}:a>=2.5&&a<=5.5&&!1===o.objectTypeFlags.velocityMed?{color:t.deselected,pickable:!1}:a<2.5&&!1===o.objectTypeFlags.velocitySlow?{color:t.deselected,pickable:!1}:(t.gradientAmt=Math.min(a/15,1),t.velGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.velGradient,pickable:!0})})).isVelocityColorScheme=!0,o.group=new o(function(e){if(null!==groups.selectedGroup)return e.isInGroup?{color:t.inGroup,pickable:!0}:e.marker?{color:t.marker[0],marker:!0,pickable:!1}:{color:t.transparent,pickable:!1}})},window.ColorScheme=o}();
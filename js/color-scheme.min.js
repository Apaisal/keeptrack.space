!function(){var e,a,t=settingsManager.colors,c=-1,l=function(e){this.colorizer=e,this.colorBuf=gl.createBuffer(),this.pickableBuf=gl.createBuffer()};(l.objectTypeFlags={}).payload=!0,l.objectTypeFlags.rocketBody=!0,l.objectTypeFlags.debris=!0,l.objectTypeFlags.facility=!0,l.objectTypeFlags.sensor=!0,l.objectTypeFlags.missile=!0,l.objectTypeFlags.trusat=!0,l.objectTypeFlags.inFOV=!0,l.objectTypeFlags.inviewAlt=!0,l.objectTypeFlags.starLow=!0,l.objectTypeFlags.starMed=!0,l.objectTypeFlags.starHi=!0,l.objectTypeFlags.satLEO=!0,l.objectTypeFlags.satGEO=!0,l.objectTypeFlags.satLow=!0,l.objectTypeFlags.satMed=!0,l.objectTypeFlags.satHi=!0,l.objectTypeFlags.satSmall=!0,l.objectTypeFlags.rcsSmall=!0,l.objectTypeFlags.rcsMed=!0,l.objectTypeFlags.rcsLarge=!0,l.objectTypeFlags.rcsUnknown=!0,l.objectTypeFlags.velocitySlow=!0,l.objectTypeFlags.velocityMed=!0,l.objectTypeFlags.velocityFast=!0,l.objectTypeFlags.ageNew=!0,l.objectTypeFlags.ageMed=!0,l.objectTypeFlags.ageOld=!0,l.objectTypeFlags.ageLost=!0,l.prototype.calculateColorBuffers=function(a,t){var l,r,o,i,s,p=0,n=Date.now();if(o&&r||(this.lastCalculation=n,l=satSet.numSats,r=new Float32Array(4*l),o=new Float32Array(l)),!a&&n-p<settingsManager.reColorMinimumTime&&0!==p)return{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf};p=n;var b,y=satSet.getSatData(),g=satSet.getSatInView();for(this.isVelocityColorScheme&&(satVel=satSet.getSatVel()),c=-1,settingsManager.isFOVBubbleModeOn||settingsManager.isShowSurvFence||settingsManager.isSatOverflyModeOn||(l-=settingsManager.maxFieldOfViewMarkers),this.isSunlightColorScheme&&(b=satSet.getSatInSun()),s=0;s<l;s++)if(e=y[s],g&&(e.inView=g[s]),b&&(e.inSun=b[s]),this.isVelocityColorScheme&&(e.velocity=Math.sqrt(satVel[3*s]*satVel[3*s]+satVel[3*s+1]*satVel[3*s+1]+satVel[3*s+2]*satVel[3*s+2])),void 0!==(i=this.colorizer(e)))try{r[4*s]=i.color[0],r[4*s+1]=i.color[1],r[4*s+2]=i.color[2],r[4*s+3]=i.color[3],o[s]=i.pickable?1:0}catch(e){db.enabled&&db.log(satSet.getSat(s));continue}return gl.bindBuffer(gl.ARRAY_BUFFER,this.colorBuf),gl.bufferData(gl.ARRAY_BUFFER,r,gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this.pickableBuf),gl.bufferData(gl.ARRAY_BUFFER,o,gl.STATIC_DRAW),{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf}},l.reloadColors=function(){t=settingsManager.colors},l.init=function(){l.default=new l(function(e){return!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type||!1!==l.objectTypeFlags.facility?!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static&&"Star"===e.type?e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:e.marker?(e.id===satSensorMarkerArray[c+1]&&c++,c>=0?{color:t.marker[c],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1}):e.static&&!1===l.objectTypeFlags.sensor?{color:t.deselected,pickable:!1}:e.static?{color:t.sensor,pickable:!0}:e.missile&&!e.inView?{color:t.missile,pickable:!0}:e.missile&&e.inView?{color:t.missileInview,pickable:!0}:!e.inView&&1===e.OT&&!1===l.objectTypeFlags.payload||cameraType.current===cameraType.PLANETARIUM&&1===e.OT&&!1===l.objectTypeFlags.payload||"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&1===e.OT&&!1===l.objectTypeFlags.payload?{color:t.deselected,pickable:!1}:!e.inView&&2===e.OT&&!1===l.objectTypeFlags.rocketBody||cameraType.current===cameraType.PLANETARIUM&&2===e.OT&&!1===l.objectTypeFlags.rocketBody||"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&2===e.OT&&!1===l.objectTypeFlags.rocketBody?{color:t.deselected,pickable:!1}:!e.inView&&3===e.OT&&!1===l.objectTypeFlags.debris||cameraType.current===cameraType.PLANETARIUM&&3===e.OT&&!1===l.objectTypeFlags.debris||"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&3===e.OT&&!1===l.objectTypeFlags.debris?{color:t.deselected,pickable:!1}:!e.inView&&4===e.OT&&!1===l.objectTypeFlags.trusat||cameraType.current===cameraType.PLANETARIUM&&4===e.OT&&!1===l.objectTypeFlags.trusat||"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&4===e.OT&&!1===l.objectTypeFlags.trusat?{color:t.deselected,pickable:!1}:cameraType.current===cameraType.ASTRONOMY?{color:t.deselected,pickable:!1}:e.inView&&!1===l.objectTypeFlags.inFOV&&cameraType.current!==cameraType.PLANETARIUM?{color:t.deselected,pickable:!1}:!e.inView||cameraType.current===cameraType.PLANETARIUM||"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag?(a="ANALSAT"===e.C?t.analyst:1===e.OT?t.payload:2===e.OT?t.rocketBody:3===e.OT?t.debris:4===e.OT?t.trusat:t.unknown,e.perigee>satellite.obsmaxrange||e.apogee<satellite.obsminrange?{color:t.transparent,pickable:!1}:(void 0===a&&console.warn(e.id),{color:a,pickable:!0})):{color:t.inview,pickable:!0}:{color:t.facility,pickable:!0}:{color:t.deselected,pickable:!1}}),l.onlyFOV=new l(function(e){return e.inView?{color:t.inview,pickable:!0}:{color:t.transparent,pickable:!1}}),(l.sunlight=new l(function(e){if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type)&&!1===l.objectTypeFlags.facility)return{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static&&"Star"===e.type)return e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.marker)return e.id===satSensorMarkerArray[c+1]&&c++,c>=0?{color:t.marker[c],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1};if(e.static&&!1===l.objectTypeFlags.sensor)return{color:t.deselected,pickable:!1};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile&&!e.inView)return{color:t.missile,pickable:!0};if(e.missile&&e.inView)return{color:t.missileInview,pickable:!0};if(e.inView&&e.inSun>0&&!0===l.objectTypeFlags.inFOV)return void 0===e.vmag?{color:t.deselected,pickable:!1}:{color:t.sunlightInview,pickable:!0};if(!e.inView&&void 0!==e.vmag){if(2==e.inSun&&!0===l.objectTypeFlags.satHi){if(e.vmag<3)return{color:t.starHi,pickable:!1};if(e.vmag<=4.5)return{color:t.starMed,pickable:!1};if(e.vmag>4.5)return{color:t.starLow,pickable:!1}}return 0==e.inSun&&!0===l.objectTypeFlags.satLow?{color:t.umbral,pickable:!1}:1==e.inSun&&!0===l.objectTypeFlags.satMed?{color:t.penumbral,pickable:!0}:{color:t.umbral,pickable:!1}}return{color:t.deselected,pickable:!1}})).isSunlightColorScheme=!0,l.apogee=new l(function(e){var a=e.apogee;return t.gradientAmt=Math.min(a/45e3,1),t.apogeeGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.apogeeGradient,pickable:!0}}),l.smallsats=new l(function(e){return 1===e.OT&&!1===l.objectTypeFlags.satSmall?{color:t.deselected,pickable:!1}:e.R<.1&&1===e.OT?{color:t.satSmall,pickable:!0}:{color:t.transparent,pickable:!1}}),l.rcs=new l(function(e){var a=e.R;return a<.1&&!1===l.objectTypeFlags.rcsSmall?{color:t.deselected,pickable:!1}:a>=.1&&a<=1&&!1===l.objectTypeFlags.rcsMed?{color:t.deselected,pickable:!1}:a>1&&!1===l.objectTypeFlags.rcsLarge?{color:t.deselected,pickable:!1}:void 0!==a&&null!=typeof a&&"N/A"!=a||!1!==l.objectTypeFlags.rcsUnknown?a<.1?{color:t.rcsSmall,pickable:!0}:a>=.1&&a<=1?{color:t.rcsMed,pickable:!0}:a>1?{color:t.rcsLarge,pickable:!0}:{color:t.rcsUnknown,pickable:!0}:{color:t.deselected,pickable:!1}}),l.countries=new l(function(e){var a=e.C;return"US"===a&&!1===l.objectTypeFlags.countryUS||cameraType.current===cameraType.PLANETARIUM&&"US"===a&&!1===l.objectTypeFlags.countryUS?{color:t.deselected,pickable:!1}:"PRC"===a&&!1===l.objectTypeFlags.countryPRC||cameraType.current===cameraType.PLANETARIUM&&"PRC"===a&&!1===l.objectTypeFlags.countryPRC?{color:t.deselected,pickable:!1}:"CIS"===a&&!1===l.objectTypeFlags.countryCIS||cameraType.current===cameraType.PLANETARIUM&&"CIS"===a&&!1===l.objectTypeFlags.countryCIS?{color:t.deselected,pickable:!1}:"US"===a?{color:t.countryUS,pickable:!0}:"PRC"===a?{color:t.countryPRC,pickable:!0}:"CIS"===a?{color:t.countryCIS,pickable:!0}:!1===l.objectTypeFlags.countryOther||cameraType.current===cameraType.PLANETARIUM&&!1===l.objectTypeFlags.countryOther?{color:t.deselected,pickable:!1}:{color:t.countryOther,pickable:!0}}),l.ageOfElset=new l(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,c=new Date,r=timeManager.getDayOfYear(c);return c=(c=c.getFullYear()).toString().substr(2,2),(a=e.TLE1.substr(18,2)===c?r-e.TLE1.substr(20,3):r-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2))<3&&l.objectTypeFlags.ageNew?{color:t.ageNew,pickable:!0}:a>=3&&a<14&&l.objectTypeFlags.ageMed?{color:t.ageMed,pickable:!0}:a>=14&&a<60&&l.objectTypeFlags.ageOld?{color:t.ageOld,pickable:!0}:a>=60&&l.objectTypeFlags.ageLost?{color:t.ageLost,pickable:!0}:{color:t.deselected,pickable:!1}}),l.lostobjects=new l(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,c=e.perigee,r=new Date,o=timeManager.getDayOfYear(r);return r=(r=r.getFullYear()).toString().substr(2,2),a=e.TLE1.substr(18,2)===r?o-e.TLE1.substr(20,3):o-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2),c>satellite.obsmaxrange||a<settingsManager.daysUntilObjectLost?{color:t.transparent,pickable:!1}:(""===$("#search").val()?$("#search").val($("#search").val()+e.SCC_NUM):$("#search").val($("#search").val()+","+e.SCC_NUM),{color:t.lostobjects,pickable:!0})}),l.leo=new l(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.apogee>2e3?{color:t.transparent,pickable:!1}:e.inView&&!0===l.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satLEO,pickable:!0}:{color:t.facility,pickable:!0}}),l.geo=new l(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.perigee<35e3?{color:t.transparent,pickable:!1}:e.inView&&!0===l.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satGEO,pickable:!0}:{color:t.facility,pickable:!0}}),(l.velocity=new l(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&l.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&l.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&l.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};var a=e.velocity;return e.inView?!1===l.objectTypeFlags.inviewAlt?{color:t.deselected,pickable:!1}:{color:t.inviewAlt,pickable:!0}:a>5.5&&!1===l.objectTypeFlags.velocityFast?{color:t.deselected,pickable:!1}:a>=2.5&&a<=5.5&&!1===l.objectTypeFlags.velocityMed?{color:t.deselected,pickable:!1}:a<2.5&&!1===l.objectTypeFlags.velocitySlow?{color:t.deselected,pickable:!1}:(t.gradientAmt=Math.min(a/15,1),t.velGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.velGradient,pickable:!0})})).isVelocityColorScheme=!0,l.group=new l(function(e){if(null!==groups.selectedGroup)return e.isInGroup?{color:t.inGroup,pickable:!0}:e.marker?{color:t.marker[0],marker:!0,pickable:!1}:{color:t.transparent,pickable:!1}})},window.ColorScheme=l}();
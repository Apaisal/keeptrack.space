!function(){var e,a,t=settingsManager.colors,r=-1,c=function(e){this.colorizer=e,this.colorBuf=gl.createBuffer(),this.pickableBuf=gl.createBuffer()};(c.objectTypeFlags={}).payload=!0,c.objectTypeFlags.rocketBody=!0,c.objectTypeFlags.debris=!0,c.objectTypeFlags.facility=!0,c.objectTypeFlags.sensor=!0,c.objectTypeFlags.missile=!0,c.objectTypeFlags.trusat=!0,c.objectTypeFlags.inFOV=!0,c.objectTypeFlags.inviewAlt=!0,c.objectTypeFlags.starLow=!0,c.objectTypeFlags.starMed=!0,c.objectTypeFlags.starHi=!0,c.objectTypeFlags.satLEO=!0,c.objectTypeFlags.satGEO=!0,c.objectTypeFlags.satLow=!0,c.objectTypeFlags.satMed=!0,c.objectTypeFlags.satHi=!0,c.objectTypeFlags.satSmall=!0,c.objectTypeFlags.rcsSmall=!0,c.objectTypeFlags.rcsMed=!0,c.objectTypeFlags.rcsLarge=!0,c.objectTypeFlags.rcsUnknown=!0,c.objectTypeFlags.velocitySlow=!0,c.objectTypeFlags.velocityMed=!0,c.objectTypeFlags.velocityFast=!0,c.objectTypeFlags.ageNew=!0,c.objectTypeFlags.ageMed=!0,c.objectTypeFlags.ageOld=!0,c.objectTypeFlags.ageLost=!0,c.prototype.calculateColorBuffers=function(a,t){var c,o,l,i,s,n=0,p=Date.now();if(l&&o||(this.lastCalculation=p,c=satSet.numSats,o=new Float32Array(4*c),l=new Float32Array(c)),!a&&p-n<settingsManager.reColorMinimumTime&&0!==n)return{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf};n=p;var b,g=satSet.getSatData(),y=satSet.getSatInView();for(this.isVelocityColorScheme&&(satVel=satSet.getSatVel()),r=-1,settingsManager.isFOVBubbleModeOn||settingsManager.isShowSurvFence||settingsManager.isSatOverflyModeOn||(c-=settingsManager.maxFieldOfViewMarkers),this.default,this.isSunlightColorScheme&&(b=satSet.getSatInSun()),s=0;s<c;s++)if(e=g[s],y&&(e.inView=y[s]),b&&(e.inSun=b[s]),this.isVelocityColorScheme&&(e.velocity=Math.sqrt(satVel[3*s]*satVel[3*s]+satVel[3*s+1]*satVel[3*s+1]+satVel[3*s+2]*satVel[3*s+2])),void 0!==(i=this.colorizer(e)))try{o[4*s]=i.color[0],o[4*s+1]=i.color[1],o[4*s+2]=i.color[2],o[4*s+3]=i.color[3],l[s]=i.pickable?1:0}catch(e){db.enabled&&db.log(satSet.getSat(s));continue}return gl.bindBuffer(gl.ARRAY_BUFFER,this.colorBuf),gl.bufferData(gl.ARRAY_BUFFER,o,gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this.pickableBuf),gl.bufferData(gl.ARRAY_BUFFER,l,gl.STATIC_DRAW),{colorBuf:this.colorBuf,pickableBuf:this.pickableBuf}},c.reloadColors=function(){t=settingsManager.colors},c.init=function(){(c.default=new c(function(e){return!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type||!1!==c.objectTypeFlags.facility?!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static&&"Star"===e.type?e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:e.marker?(e.id===satSensorMarkerArray[r+1]&&r++,r>=0?{color:t.marker[r],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1}):e.static&&!1===c.objectTypeFlags.sensor?{color:t.deselected,pickable:!1}:e.static?{color:t.sensor,pickable:!0}:e.missile&&!e.inView?{color:t.missile,pickable:!0}:e.missile&&e.inView?{color:t.missileInview,pickable:!0}:!e.inView&&1===e.OT&&!1===c.objectTypeFlags.payload||cameraType.current===cameraType.PLANETARIUM&&1===e.OT&&!1===c.objectTypeFlags.payload||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&1===e.OT&&!1===c.objectTypeFlags.payload?{color:t.deselected,pickable:!1}:!e.inView&&2===e.OT&&!1===c.objectTypeFlags.rocketBody||cameraType.current===cameraType.PLANETARIUM&&2===e.OT&&!1===c.objectTypeFlags.rocketBody||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&2===e.OT&&!1===c.objectTypeFlags.rocketBody?{color:t.deselected,pickable:!1}:!e.inView&&3===e.OT&&!1===c.objectTypeFlags.debris||cameraType.current===cameraType.PLANETARIUM&&3===e.OT&&!1===c.objectTypeFlags.debris||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&3===e.OT&&!1===c.objectTypeFlags.debris?{color:t.deselected,pickable:!1}:!e.inView&&4===e.OT&&!1===c.objectTypeFlags.trusat||cameraType.current===cameraType.PLANETARIUM&&4===e.OT&&!1===c.objectTypeFlags.trusat||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag&&4===e.OT&&!1===c.objectTypeFlags.trusat?{color:t.deselected,pickable:!1}:cameraType.current===cameraType.ASTRONOMY?{color:t.deselected,pickable:!1}:e.inView&&!1===c.objectTypeFlags.inFOV&&cameraType.current!==cameraType.PLANETARIUM?{color:t.deselected,pickable:!1}:!e.inView||cameraType.current===cameraType.PLANETARIUM||objectManager.isSensorManagerLoaded&&"Observer"==sensorManager.currentSensor.type&&void 0===e.vmag?(a="ANALSAT"===e.C?t.analyst:1===e.OT?t.payload:2===e.OT?t.rocketBody:3===e.OT?t.debris:4===e.OT?t.trusat:t.unknown,e.perigee>satellite.obsmaxrange||e.apogee<satellite.obsminrange?{color:t.transparent,pickable:!1}:void 0===a?(console.warn(e.id),{color:t.transparent,pickable:!1}):{color:a,pickable:!0}):{color:t.inview,pickable:!0}:{color:t.facility,pickable:!0}:{color:t.deselected,pickable:!1}})).default=!0,c.onlyFOV=new c(function(e){return e.inView?{color:t.inview,pickable:!0}:{color:t.transparent,pickable:!1}}),(c.sunlight=new c(function(e){if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type)&&!1===c.objectTypeFlags.facility)return{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static&&"Star"===e.type)return e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.marker)return e.id===satSensorMarkerArray[r+1]&&r++,r>=0?{color:t.marker[r],marker:!0,pickable:!1}:{color:t.marker[0],marker:!0,pickable:!1};if(e.static&&!1===c.objectTypeFlags.sensor)return{color:t.deselected,pickable:!1};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile&&!e.inView)return{color:t.missile,pickable:!0};if(e.missile&&e.inView)return{color:t.missileInview,pickable:!0};if(e.inView&&e.inSun>0&&!0===c.objectTypeFlags.inFOV)return void 0===e.vmag?{color:t.deselected,pickable:!1}:{color:t.sunlightInview,pickable:!0};if(!e.inView&&void 0!==e.vmag){if(2==e.inSun&&!0===c.objectTypeFlags.satHi){if(e.vmag<3)return{color:t.starHi,pickable:!1};if(e.vmag<=4.5)return{color:t.starMed,pickable:!1};if(e.vmag>4.5)return{color:t.starLow,pickable:!1}}return 0==e.inSun&&!0===c.objectTypeFlags.satLow?{color:t.umbral,pickable:!1}:1==e.inSun&&!0===c.objectTypeFlags.satMed?{color:t.penumbral,pickable:!0}:{color:t.umbral,pickable:!1}}return{color:t.deselected,pickable:!1}})).isSunlightColorScheme=!0,c.apogee=new c(function(e){var a=e.apogee;return t.gradientAmt=Math.min(a/45e3,1),t.apogeeGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.apogeeGradient,pickable:!0}}),c.smallsats=new c(function(e){return 1===e.OT&&!1===c.objectTypeFlags.satSmall?{color:t.deselected,pickable:!1}:e.R<.1&&1===e.OT?{color:t.satSmall,pickable:!0}:{color:t.transparent,pickable:!1}}),c.rcs=new c(function(e){var a=e.R;return a<.1&&!1===c.objectTypeFlags.rcsSmall?{color:t.deselected,pickable:!1}:a>=.1&&a<=1&&!1===c.objectTypeFlags.rcsMed?{color:t.deselected,pickable:!1}:a>1&&!1===c.objectTypeFlags.rcsLarge?{color:t.deselected,pickable:!1}:void 0!==a&&null!=typeof a&&"N/A"!=a||!1!==c.objectTypeFlags.rcsUnknown?a<.1?{color:t.rcsSmall,pickable:!0}:a>=.1&&a<=1?{color:t.rcsMed,pickable:!0}:a>1?{color:t.rcsLarge,pickable:!0}:{color:t.rcsUnknown,pickable:!0}:{color:t.deselected,pickable:!1}}),c.countries=new c(function(e){var a=e.C;return"US"===a&&!1===c.objectTypeFlags.countryUS||cameraType.current===cameraType.PLANETARIUM&&"US"===a&&!1===c.objectTypeFlags.countryUS?{color:t.deselected,pickable:!1}:"PRC"===a&&!1===c.objectTypeFlags.countryPRC||cameraType.current===cameraType.PLANETARIUM&&"PRC"===a&&!1===c.objectTypeFlags.countryPRC?{color:t.deselected,pickable:!1}:"CIS"===a&&!1===c.objectTypeFlags.countryCIS||cameraType.current===cameraType.PLANETARIUM&&"CIS"===a&&!1===c.objectTypeFlags.countryCIS?{color:t.deselected,pickable:!1}:"US"===a?{color:t.countryUS,pickable:!0}:"PRC"===a?{color:t.countryPRC,pickable:!0}:"CIS"===a?{color:t.countryCIS,pickable:!0}:!1===c.objectTypeFlags.countryOther||cameraType.current===cameraType.PLANETARIUM&&!1===c.objectTypeFlags.countryOther?{color:t.deselected,pickable:!1}:{color:t.countryOther,pickable:!0}}),c.ageOfElset=new c(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,r=new Date,o=timeManager.getDayOfYear(r);return r=(r=r.getFullYear()).toString().substr(2,2),(a=e.TLE1.substr(18,2)===r?o-e.TLE1.substr(20,3):o-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2))<3&&c.objectTypeFlags.ageNew?{color:t.ageNew,pickable:!0}:a>=3&&a<14&&c.objectTypeFlags.ageMed?{color:t.ageMed,pickable:!0}:a>=14&&a<60&&c.objectTypeFlags.ageOld?{color:t.ageOld,pickable:!0}:a>=60&&c.objectTypeFlags.ageLost?{color:t.ageLost,pickable:!0}:{color:t.deselected,pickable:!1}}),c.lostobjects=new c(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};if(e.missile)return{color:t.transparent,pickable:!1};var a,r=e.perigee,o=new Date,l=timeManager.getDayOfYear(o);return o=(o=o.getFullYear()).toString().substr(2,2),a=e.TLE1.substr(18,2)===o?l-e.TLE1.substr(20,3):l-e.TLE1.substr(20,3)+365*e.TLE1.substr(17,2),r>satellite.obsmaxrange||a<settingsManager.daysUntilObjectLost?{color:t.transparent,pickable:!1}:(""===$("#search").val()?$("#search").val($("#search").val()+e.SCC_NUM):$("#search").val($("#search").val()+","+e.SCC_NUM),{color:t.lostobjects,pickable:!0})}),c.leo=new c(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.apogee>2e3?{color:t.transparent,pickable:!1}:e.inView&&!0===c.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satLEO,pickable:!0}:{color:t.facility,pickable:!0}}),c.geo=new c(function(e){return e.static&&"Star"===e.type?e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1}:!e.static||"Launch Facility"!==e.type&&"Control Facility"!==e.type?e.static?{color:t.sensor,pickable:!0}:e.perigee<35e3?{color:t.transparent,pickable:!1}:e.inView&&!0===c.objectTypeFlags.inFOV?{color:t.inview,pickable:!0}:{color:t.satGEO,pickable:!0}:{color:t.facility,pickable:!0}}),(c.velocity=new c(function(e){if(e.static&&"Star"===e.type)return e.vmag>=4.7&&c.objectTypeFlags.starLow?{color:t.starLow,pickable:!0}:e.vmag>=3.5&&e.vmag<4.7&&c.objectTypeFlags.starMed?{color:t.starMed,pickable:!0}:e.vmag<3.5&&c.objectTypeFlags.starHi?{color:t.starHi,pickable:!0}:{color:t.deselected,pickable:!1};if(e.static&&("Launch Facility"===e.type||"Control Facility"===e.type))return{color:t.facility,pickable:!0};if(e.static)return{color:t.sensor,pickable:!0};var a=e.velocity;return e.inView?!1===c.objectTypeFlags.inviewAlt?{color:t.deselected,pickable:!1}:{color:t.inviewAlt,pickable:!0}:a>5.5&&!1===c.objectTypeFlags.velocityFast?{color:t.deselected,pickable:!1}:a>=2.5&&a<=5.5&&!1===c.objectTypeFlags.velocityMed?{color:t.deselected,pickable:!1}:a<2.5&&!1===c.objectTypeFlags.velocitySlow?{color:t.deselected,pickable:!1}:(t.gradientAmt=Math.min(a/15,1),t.velGradient=[1-t.gradientAmt,t.gradientAmt,0,1],{color:t.velGradient,pickable:!0})})).isVelocityColorScheme=!0,c.group=new c(function(e){if(null!==groups.selectedGroup)return e.isInGroup?{color:t.inGroup,pickable:!0}:e.marker?{color:t.marker[0],marker:!0,pickable:!1}:{color:t.transparent,pickable:!1}})},window.ColorScheme=c}();
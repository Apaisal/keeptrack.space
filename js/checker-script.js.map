{"version":3,"sources":["webpack://keeptrack.space/./src/js/checker-script.js"],"names":["detectIe","checkReadyState","settingsManager","offline","checkRequest","Request","installDirectory","fetch","then","response","status","window","location","assign","readyForInteraction","BrowserA","navigator","userAgent","browsers","test","document","readyState","addEventListener","intervalID","setInterval","isReady","displayElement","clearInterval","id","value","getElementById","style","display"],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AAEAA,QAAQ,G,CAER;AACA;AACA;AACA;;AACA,CAAC,SAASC,eAAT,GAA4B;AAC3B,MAAIC,eAAe,CAACC,OAApB,EAA6B;AAC7B,MAAIC,YAAY,GAAG,IAAIC,OAAJ,WAAeH,eAAe,CAACI,gBAA/B,yBAAnB;AAEAC,OAAK,CAACH,YAAD,CAAL,CAAoBI,IAApB,CAAyB,UAAUC,QAAV,EAAoB;AAC3C;AAEA,QAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B;AACA;AACAC,YAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,eAAvB;AACD,KAJD,MAIO;AACLC,yBAAmB;AACpB;AACF,GAVD;AAWD,CAfD;;AAiBA,SAASd,QAAT,GAAoB;AAChB,MAAIe,QAAQ,GAAGC,SAAS,CAACC,SAAzB;AACA,MAAIC,QAAQ,GAAI,oCAAD,CAAgCC,IAAhC,CAAqCJ,QAArC,CAAf;;AAEA,MAAIG,QAAQ,KAAK,KAAjB,EAAwB;AACpBP,UAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyB,cAAzB;AACH,GAFD,MAEO;AACH,WAAO,IAAP;AACH;AACJ;;AACD,SAASC,mBAAT,GAA+B;AAC7B;AACA;AACA;AACA;AACA,MAAIM,QAAQ,CAACC,UAAT,KAAwB,UAA5B,EAAwC;AACtCD,YAAQ,CAACE,gBAAT,CAA0B,kBAA1B,EAA8C,YAAY;AACxD,UAAIC,UAAU,GAAGZ,MAAM,CAACa,WAAP,CAAmBC,OAAnB,EAA4B,IAA5B,CAAjB;;AAEA,eAASA,OAAT,GAAmB;AACjB,YAAIL,QAAQ,CAACC,UAAT,KAAwB,aAA5B,EAA2C;AACzCK,wBAAc,CAAC,gBAAD,EAAmB,KAAnB,CAAd;AACD,SAFD,MAEO,IAAIN,QAAQ,CAACC,UAAT,KAAwB,UAA5B,EAAwC;AAC7CV,gBAAM,CAACgB,aAAP,CAAqBJ,UAArB;AACAG,wBAAc,CAAC,gBAAD,EAAmB,IAAnB,CAAd;AACD;AACF;AACF,KAXD;AAYD,GAbD,MAaO;AACL;AACAA,kBAAc,CAAC,gBAAD,EAAmB,IAAnB,CAAd;AACD;AACF;;AACD,SAASA,cAAT,CAAwBE,EAAxB,EAA4BC,KAA5B,EAAmC;AACjCT,UAAQ,CAACU,cAAT,CAAwBF,EAAxB,EAA4BG,KAA5B,CAAkCC,OAAlC,GAA4CH,KAAK,GAC/C,OAD+C,GAE/C,MAFF;AAGD,C","file":"checker-script.js","sourcesContent":["/* /////////////////////////////////////////////////////////////////////////////\n\nThis script is intended to check that the application is ready for interaction.\n\n///////////////////////////////////////////////////////////////////////////// */\n\ndetectIe();\n\n// Looking for an essential file such as shaders.js ensures that the install\n// directory is currectly set. If we look for the index.htm file then it will\n// always be found (otherwise how did we load this script). If we look for\n// optional modules like sensorManager.js then it could fail to load unnecessarily\n(function checkReadyState () {\n  if (settingsManager.offline) return;\n  let checkRequest = new Request(`${settingsManager.installDirectory}js/objectManager.js`);\n\n  fetch(checkRequest).then(function (response) {\n    // console.log(response.status + \"OK\");\n\n    if (response.status === 404) {\n      // This same file can be used by .htaccess to redirect bad links\n      // across the whole server (ex. keeptrack.space/fakepage.html)\n      window.location.assign('/res/404.html');\n    } else {\n      readyForInteraction();\n    }\n  });\n})();\n\nfunction detectIe() {\n    let BrowserA = navigator.userAgent;\n    let browsers = (/Chrome|Safari|Firefox|Edg/ui).test(BrowserA);\n\n    if (browsers === false) {\n        window.location.assign = '/res/IE.html';\n    } else {\n        return true;\n    }\n}\nfunction readyForInteraction() {\n  // This looks to see if the main page is loaded.\n  // It does NOT know if all of the async loading is complete. The satellite\n  // database (.json file) is the largest async file and it has to  be processed\n  // by the sat-cruncher web worker before webgl can draw the satellites\n  if (document.readyState !== 'complete') {\n    document.addEventListener('readystatechange', function () {\n      let intervalID = window.setInterval(isReady, 1000);\n\n      function isReady() {\n        if (document.readyState === 'interactive') {\n          displayElement('main-container', false);\n        } else if (document.readyState === 'complete') {\n          window.clearInterval(intervalID);\n          displayElement('main-container', true);\n        }\n      }\n    });\n  } else {\n    // Sometimes it loads really fast\n    displayElement('main-container', true);\n  }\n}\nfunction displayElement(id, value) {\n  document.getElementById(id).style.display = value\n  ? 'block'\n  : 'none';\n}\n"],"sourceRoot":""}